{"version":3,"sources":["../../src/RamachandranComponent.js"],"names":["Object","defineProperty","exports","value","d3","require","polymer_element_js_1","HeatMapContours_1","LineContours_1","parsePdb_1","RamachandranComponent","createChart","bind","fillColorFunction","pdb","default","pdbId","downloadAndParse","jsonObject","residueArray","outliersType","outlDict","rsrz","hiddenResidues","selectedResidues","ramachandranOutliers","sidechainOutliers","favored","allowed","outliersList","ramaContourPlotType","contourColoringStyle","residueColorStyle","modelsToShowNumbers","modelsToShow","map","d","push","parseInt","objSize","window","screen","availWidth","width","symbolTypes","circle","symbol","type","symbolCircle","size","triangle","symbolTriangle","timeoutId","currentTime","lastTimeChanged","rsrzCount","clashes","highlightedResidues","residuesOnCanvas","lastSelection","tooltipHeight","tooltipWidth","newValue","oldValue","updateChart","chainsToShow","select","text","toUpperCase","height","xScale","scaleLinear","domain","range","xBottomAxis","axisBottom","xTopAxis","axisTop","xValue","xMap","tooltip","append","attr","style","yScale","yLeftAxis","axisLeft","yRightAxis","axisRight","yValue","yMap","makeYGridlines","makeXGridlines","svgContainer","classed","canvasContainer","call","tickSize","selectAll","remove","colorSelect","on","property","changeResiduesColors","addSummaryInfo","plotTypeSelect","baseContours","ramaForm","entryInfo","addEventListeners","entityToShow","onMouseOutResidue","onMouseOverResidue","switchPlotType","i","prePro","length","aa","cisPeptide","sortJson","data","filter","indexOf","chain","modelId","toString","phi","psi","actualRes","enter","id","num","idSelector","rama","merge","computeOpacity","node","opacity","clearTimeout","sort","a","b","clickEvents","mouseOutEvents","scrollTimer","lastScrollFireTime","unHighlightObject","event","eventData","getResidueNode","changeObjectSize","transition","duration","onClick","res","forEach","dat","pop","chainId","residueName","entityId","residueNumber","highLightObject","addEventListener","minMouseOverTime","now","Date","getTime","mouseOver","includes","setTimeout","detail","authorResNum","begin","end","empty","String","toFixed","undefined","drawingType","compute","computeStats","highlightColor","dispatchCustomEvent","changeContours","html","tooltipText","tempStr","pageX","pageY","outTime","console","log","resArray","slice","outliersTable","sortedTable","rows","exit","cells","contourColorStyle","clearCanvas","img","Image","svgImg","src","generalContour","lineGeneralContour","ileVal","lineIleVal","linePrePro","gly","lineGly","transPro","lineTransPro","cisPro","lineCisPro","context","getContext","clearRect","globalAlpha","onload","drawImage","fillTmp","changeOpacity","name","CustomEvent","entry","dispatchEvent","toDefault","getTimeout","smaller","makeInvisible","residues","split","nodes","reflectToAttribute","notify","observer","Array","Number","element","HTMLElement","PolymerElement","customElements","define","ndow"],"mappings":"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","file":"RamachandranComponent.js","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst d3 = require(\"d3\");\r\nconst polymer_element_js_1 = require(\"@polymer/polymer/polymer-element.js\");\r\nconst HeatMapContours_1 = require(\"../contours/HeatMapContours\");\r\nconst LineContours_1 = require(\"../contours/LineContours\");\r\nrequire(\"bootstrap/dist/css/bootstrap.css\");\r\nrequire(\"../public/index.css\");\r\nconst parsePdb_1 = require(\"./parsePdb\");\r\nclass RamachandranComponent extends polymer_element_js_1.PolymerElement {\r\n    static get properties() {\r\n        return {\r\n            pdbId: {\r\n                type: String,\r\n                reflectToAttribute: true,\r\n                notify: true,\r\n                observer: '_pdbIdChanged'\r\n            },\r\n            chainsToShow: {\r\n                type: Array,\r\n                observer: '_chainsChanged',\r\n                reflectToAttribute: true,\r\n                notify: true\r\n            },\r\n            modelsToShow: {\r\n                type: Array,\r\n                observer: '_modelsChanged',\r\n                reflectToAttribute: true,\r\n                notify: true\r\n            },\r\n            residueColorStyle: {\r\n                type: Number,\r\n                reflectToAttribute: true\r\n            },\r\n            contourColoringStyle: {\r\n                type: Number,\r\n                reflectToAttribute: true\r\n            },\r\n            ramaContourPlotType: {\r\n                type: Number,\r\n                reflectToAttribute: true\r\n            },\r\n            element: {\r\n                type: HTMLElement,\r\n                reflectToAttribute: true\r\n            },\r\n        };\r\n    }\r\n    connectedCallback() {\r\n        super.connectedCallback();\r\n        this.createChart = this.createChart.bind(this);\r\n        this.fillColorFunction = this.fillColorFunction.bind(this);\r\n        const pdb = new parsePdb_1.default(this.pdbId);\r\n        pdb.downloadAndParse();\r\n        RamachandranComponent.jsonObject = pdb.residueArray;\r\n        this.outliersType = pdb.outlDict;\r\n        this.rsrz = pdb.rsrz;\r\n        RamachandranComponent.hiddenResidues = [];\r\n        RamachandranComponent.selectedResidues = [];\r\n        this.ramachandranOutliers = 0;\r\n        this.sidechainOutliers = 0;\r\n        RamachandranComponent.favored = 0;\r\n        RamachandranComponent.allowed = 0;\r\n        RamachandranComponent.outliersList = [];\r\n        this.ramaContourPlotType = 1;\r\n        RamachandranComponent.contourColoringStyle = 1;\r\n        this.residueColorStyle = 1;\r\n        this.modelsToShowNumbers = [];\r\n        this.modelsToShow.map((d) => {\r\n            this.modelsToShowNumbers.push(parseInt(d));\r\n        });\r\n        let objSize = 40;\r\n        if (window.screen.availWidth < 1920) {\r\n            objSize = 30;\r\n        }\r\n        if (window.screen.width < 350) {\r\n            objSize = 5;\r\n        }\r\n        // symbolTypes\r\n        RamachandranComponent.symbolTypes = {\r\n            circle: d3.symbol().type(d3.symbolCircle).size(objSize),\r\n            triangle: d3.symbol().type(d3.symbolTriangle).size(objSize)\r\n        };\r\n        RamachandranComponent.timeoutId = 0;\r\n        RamachandranComponent.currentTime = 0;\r\n        RamachandranComponent.lastTimeChanged = 0;\r\n        this.rsrzCount = 0;\r\n        this.clashes = 0;\r\n        RamachandranComponent.highlightedResidues = [];\r\n        RamachandranComponent.residuesOnCanvas = [];\r\n        this.createChart();\r\n        this.lastSelection = {};\r\n        RamachandranComponent.tooltipHeight = 58;\r\n        RamachandranComponent.tooltipWidth = 90;\r\n    }\r\n    _pdbIdChanged(newValue, oldValue) {\r\n        if (typeof oldValue == 'undefined')\r\n            return;\r\n        const pdb = new parsePdb_1.default(this.pdbId);\r\n        pdb.downloadAndParse();\r\n        RamachandranComponent.jsonObject = pdb.residueArray;\r\n        this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShow);\r\n        d3.select('#rama-info-pdbid').text(this.pdbId.toUpperCase());\r\n    }\r\n    _chainsChanged(newValue, oldValue) {\r\n        if (typeof oldValue == 'undefined')\r\n            return;\r\n        this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShow);\r\n        d3.select('#rama-info-chains').text(this.chainsToShow);\r\n    }\r\n    _modelsChanged(newValue, oldValue) {\r\n        if (typeof oldValue == 'undefined')\r\n            return;\r\n        this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShow);\r\n        d3.select('#rama-info-models').text(this.modelsToShow);\r\n    }\r\n    /**\r\n     * creates basic chart, add axes, creates tooltip\r\n     */\r\n    createChart() {\r\n        let width = 500, height = 500;\r\n        if (width > 768) {\r\n            width = 580;\r\n        }\r\n        if (height > 768) {\r\n            height = 580;\r\n        }\r\n        // setup x\r\n        const xScale = d3.scaleLinear()\r\n            .domain([-180, 180])\r\n            .range([0, (width)]);\r\n        let xBottomAxis = d3.axisBottom(xScale);\r\n        let xTopAxis = d3.axisTop(xScale);\r\n        const xValue = (d) => d['phi'];\r\n        this.xMap = (d) => xScale(xValue(d));\r\n        // tooltip\r\n        this.tooltip = d3.select('body').append('div')\r\n            .attr('class', 'rama-tooltip')\r\n            .attr('height', 0)\r\n            .style('opacity', 0);\r\n        // setup y\r\n        const yScale = d3.scaleLinear()\r\n            .domain([180, -180])\r\n            .range([0, (height)]);\r\n        let yLeftAxis = d3.axisLeft(yScale);\r\n        let yRightAxis = d3.axisRight(yScale);\r\n        const yValue = (d) => d['psi'];\r\n        this.yMap = (d) => yScale(yValue(d));\r\n        function makeYGridlines() {\r\n            return d3.axisRight(yScale);\r\n        }\r\n        function makeXGridlines() {\r\n            return d3.axisTop(xScale);\r\n        }\r\n        this.svgContainer = d3.select('ramachandran-component').append('div')\r\n            .attr('id', 'rama-svg-container')\r\n            .attr('height', height)\r\n            .attr('border', '1px solid black')\r\n            .append('svg')\r\n            .attr('max-width', width)\r\n            .classed('svg-container', true)\r\n            .attr('id', 'rama-svg')\r\n            .attr('preserveAspectRatio', 'xMinYMin meet')\r\n            .attr('viewBox', '0 0 ' + width + ' ' + height)\r\n            .classed('svg-content-responsive', true)\r\n            .style('overflow', 'visible');\r\n        RamachandranComponent.canvasContainer = d3.select('#rama-svg-container')\r\n            .append('canvas')\r\n            .classed('img-responsive', true)\r\n            .attr('id', 'rama-canvas')\r\n            .attr('width', width)\r\n            .attr('height', height)\r\n            .classed('svg-content-responsive', true)\r\n            .attr('preserveAspectRatio', 'xMinYMin meet')\r\n            .attr('viewBox', '0 0 ' + width + ' ' + height)\r\n            .style('padding', '30px 30px 30px 50px')\r\n            .style('overflow', 'visible');\r\n        // // add axes\r\n        this.svgContainer.append('g')\r\n            .call(xTopAxis)\r\n            .attr('id', 'x-axis');\r\n        this.svgContainer.append('g')\r\n            .attr('transform', 'translate(0,' + (height) + ')')\r\n            .call(xBottomAxis)\r\n            .attr('id', 'x-axis');\r\n        this.svgContainer.append('g')\r\n            .call(yLeftAxis)\r\n            .attr('id', 'y-axis');\r\n        this.svgContainer.append('g')\r\n            .attr('transform', () => 'translate(' + (width) + ', 0)')\r\n            .call(yRightAxis)\r\n            .attr('id', 'y-axis');\r\n        this.svgContainer.append('g')\r\n            .attr('class', 'rama-grid')\r\n            .attr('transform', 'translate(0,' + height + ')')\r\n            .call(makeXGridlines()\r\n            .tickSize(width));\r\n        this.svgContainer.append('g')\r\n            .attr('class', 'rama-grid')\r\n            .call(makeYGridlines()\r\n            .tickSize(height));\r\n        // axis labels\r\n        // phi label\r\n        this.svgContainer.append('text')\r\n            .attr('x', width / 2)\r\n            .attr('y', height + 35)\r\n            .style('text-anchor', 'middle')\r\n            .style('fill', '#000')\r\n            .text('\\u03A6');\r\n        // psi label\r\n        this.svgContainer.append('text')\r\n            .attr('x', 0 - (height / 2))\r\n            .attr('y', -35)\r\n            .style('text-anchor', 'middle')\r\n            .style('fill', '#000')\r\n            .attr('transform', 'rotate(-90)')\r\n            .text('\\u03A8');\r\n        //\r\n        // // outliers headline\r\n        // d3.select('#rama-root').append('div')\r\n        //     .attr('class', 'rama-outliers-div')\r\n        //     .append('div')\r\n        //     .attr('class', 'rama-outliers-headline')\r\n        //     .append('h4')\r\n        //     .text('OUTLIERS');\r\n        //\r\n        // d3.select('.rama-outliers-div').append('div')\r\n        //     .attr('class', 'outliers-container');\r\n        d3.selectAll('g.rama-grid g.tick text').remove();\r\n        d3.select('#rama-svg-container').append('div').attr('id', 'rama-sum').attr('class', 'rama-set-cl');\r\n        d3.select('#rama-svg-container').append('div').attr('id', 'rama-settings').attr('class', 'rama-set-cl');\r\n        let colorSelect = d3.select('#rama-settings').append('select').attr('id', 'rama-coloring');\r\n        colorSelect.append('option').attr('value', 1).text('Default');\r\n        colorSelect.append('option').attr('value', 2).text('Quality');\r\n        colorSelect.append('option').attr('value', 3).text('RSRZ');\r\n        colorSelect.on('change', () => {\r\n            this.residueColorStyle = parseInt(d3.select('#rama-coloring').property('value'));\r\n            this.changeResiduesColors(this.residueColorStyle);\r\n            this.addSummaryInfo();\r\n        });\r\n        let plotTypeSelect = d3.select('#rama-settings').append('select').attr('id', 'rama-plot-type');\r\n        plotTypeSelect.append('option').attr('value', 1).text('General case');\r\n        plotTypeSelect.append('option').attr('value', 2).text('Isoleucine and valine');\r\n        plotTypeSelect.append('option').attr('value', 3).text('Pre-proline');\r\n        plotTypeSelect.append('option').attr('value', 4).text('Glycine');\r\n        plotTypeSelect.append('option').attr('value', 5).text('Trans proline');\r\n        plotTypeSelect.append('option').attr('value', 6).text('Cis proline');\r\n        plotTypeSelect.on('change', () => {\r\n            this.ramaContourPlotType = parseInt(d3.select('#rama-plot-type').property('value'));\r\n            this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShowNumbers);\r\n            RamachandranComponent.baseContours(this.ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n        });\r\n        let ramaForm = d3.select('#rama-settings').append('form').attr('id', 'rama-contour-style');\r\n        ramaForm.append('label').classed('rama-contour-style', true).text('Contour').append('input')\r\n            .attr('type', 'radio')\r\n            .attr('name', 'contour-style')\r\n            .attr('value', 1)\r\n            .attr('checked', true)\r\n            .classed('rama-contour-radio', true);\r\n        ramaForm.append('label').classed('rama-contour-style', true).text('Heat Map').append('input')\r\n            .attr('type', 'radio')\r\n            .attr('name', 'contour-style')\r\n            .attr('value', 2)\r\n            .classed('rama-contour-radio', true);\r\n        ramaForm.on('change', () => {\r\n            RamachandranComponent.contourColoringStyle = parseInt(d3.select('input[name=\"contour-style\"]:checked').property('value'));\r\n            RamachandranComponent.baseContours(this.ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n        });\r\n        let entryInfo = d3.select('#rama-settings').append('div').style('display', 'inline-block')\r\n            .style('width', '27%').style('margin', '5px 5px 5px 10px');\r\n        entryInfo.append('div').style('display', 'inline-block').style('width', '28%')\r\n            .attr('id', 'rama-info-pdbid').text(this.pdbId.toUpperCase());\r\n        entryInfo.append('div').style('display', 'inline-block')\r\n            .attr('id', 'rama-info-chains').style('width', '36%')\r\n            .style('text-align', 'right').text(this.chainsToShow);\r\n        entryInfo.append('div').style('display', 'inline-block').attr('id', 'rama-info-models')\r\n            .style('width', '36%').style('text-align', 'right').text(this.modelsToShow);\r\n        this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShowNumbers);\r\n        RamachandranComponent.baseContours(this.ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n        this.addEventListeners();\r\n    }\r\n    /**\r\n     * change residues in chart\r\n     * @param {any[]} chainsToShow\r\n     * @param {number} ramaContourPlotType\r\n     * @param {number[]} entityToShow\r\n     */\r\n    updateChart(chainsToShow, ramaContourPlotType, entityToShow) {\r\n        this.svgContainer.selectAll('g.dataGroup').remove();\r\n        //reset counters\r\n        this.sidechainOutliers = 0;\r\n        this.rsrzCount = 0;\r\n        this.ramachandranOutliers = 0;\r\n        RamachandranComponent.allowed = 0;\r\n        RamachandranComponent.favored = 0;\r\n        this.clashes = 0;\r\n        RamachandranComponent.residuesOnCanvas = [];\r\n        RamachandranComponent.outliersList = [];\r\n        let width = 500;\r\n        const { fillColorFunction, outliersType, rsrz, tooltip, residueColorStyle } = this;\r\n        const jsonObject = RamachandranComponent.jsonObject;\r\n        let { onMouseOutResidue, onMouseOverResidue } = this;\r\n        if (width > 768) {\r\n            width = 580;\r\n        }\r\n        // if (height > 768) {\r\n        //     height = 580;\r\n        // }\r\n        const pdbId = this.pdbId;\r\n        // scales\r\n        const xScale = d3.scaleLinear()\r\n            .domain([-180, 180])\r\n            .range([0, (width)]);\r\n        // .range([0, (0.985 * width)]);\r\n        const yScale = d3.scaleLinear()\r\n            .domain([180, -180])\r\n            .range([0, (width)]);\r\n        /**\r\n         * determines which residues will be displayed depending on ramaContourPlotType\r\n         * @param d\r\n         * @param {number} i\r\n         * @returns {any}\r\n         */\r\n        function switchPlotType(d, i) {\r\n            let prePro = false;\r\n            if (i + 1 != jsonObject.length && jsonObject[i + 1].aa == 'PRO') {\r\n                d.prePro = true;\r\n                prePro = true;\r\n            }\r\n            switch (ramaContourPlotType) {\r\n                case 1:\r\n                    return d;\r\n                case 2:\r\n                    if (d.aa == 'ILE' || d.aa == 'VAL') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    if (prePro)\r\n                        return d;\r\n                    break;\r\n                case 4:\r\n                    if (d.aa == 'GLY') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                case 5:\r\n                    if (d.cisPeptide == null && d.aa == 'PRO') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                case 6:\r\n                    if (d.cisPeptide == 'Y' && d.aa == 'PRO') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                default:\r\n                    return d;\r\n            }\r\n        }\r\n        // sort because of svg z-index\r\n        this.sortJson(jsonObject, residueColorStyle, outliersType, rsrz);\r\n        // outliersText\r\n        d3.selectAll('.outliers').remove();\r\n        d3.selectAll('table').remove();\r\n        this.svgContainer.selectAll('.shapes')\r\n            .data(jsonObject.filter((d, i) => {\r\n            if (chainsToShow.indexOf(d.chain) != -1 && (entityToShow.indexOf(d.modelId) != -1 ||\r\n                entityToShow.indexOf(d.modelId.toString()))) {\r\n                if (d.phi != null || d.psi != null) {\r\n                    const actualRes = switchPlotType(d, i);\r\n                    if (typeof actualRes != 'undefined') {\r\n                        RamachandranComponent.residuesOnCanvas.push(actualRes);\r\n                        return actualRes;\r\n                    }\r\n                }\r\n            }\r\n        }))\r\n            .enter()\r\n            .append('g')\r\n            .attr('class', 'dataGroup')\r\n            .append('path')\r\n            .attr('id', (d) => {\r\n            const id = d.aa + '-' + d.chain + '-' + d.modelId + '-' + d.num;\r\n            d.idSelector = id;\r\n            if (residueColorStyle !== 3) {\r\n                if (d.rama === 'OUTLIER') {\r\n                    RamachandranComponent.outliersList.push(d);\r\n                }\r\n                if (d.rama === 'Favored') {\r\n                    RamachandranComponent.favored++;\r\n                }\r\n                if (d.rama === 'Allowed') {\r\n                    RamachandranComponent.allowed++;\r\n                }\r\n                return id;\r\n            }\r\n            if (d.rama === 'OUTLIER' && typeof rsrz[d.num] !== 'undefined') {\r\n                RamachandranComponent.outliersList.push(d);\r\n                return id;\r\n            }\r\n            return id;\r\n        })\r\n            .attr('d', (d) => {\r\n            if (d.aa === 'GLY') {\r\n                return RamachandranComponent.symbolTypes.triangle();\r\n            }\r\n            return RamachandranComponent.symbolTypes.circle();\r\n        })\r\n            .attr('transform', (d) => 'translate(' + xScale(d.phi) + ',' + yScale(d.psi) + ')')\r\n            .merge(this.svgContainer)\r\n            // .style('fill', 'transparent')\r\n            .style('fill', (d) => fillColorFunction(d, residueColorStyle, outliersType, rsrz, true))\r\n            .style('opacity', (d) => {\r\n            return RamachandranComponent.computeOpacity(fillColorFunction(d, residueColorStyle, outliersType, rsrz));\r\n        })\r\n            .on('mouseover', function (d) {\r\n            if (d3.select(this).node().style.opacity == 0)\r\n                return;\r\n            onMouseOverResidue(d, pdbId, ramaContourPlotType, residueColorStyle, tooltip, outliersType, rsrz);\r\n        })\r\n            .on('mouseout', function (d) {\r\n            if (d3.select(this).node().style.opacity == 0)\r\n                return;\r\n            window.clearTimeout(RamachandranComponent.timeoutId);\r\n            onMouseOutResidue(d, pdbId, ramaContourPlotType, residueColorStyle, tooltip, outliersType, rsrz, fillColorFunction);\r\n        });\r\n        // .on('click', function(d: any) {\r\n        //     if (highlightedResidues.length != 0) {\r\n        //         highlightedResidues.forEach((d: any) => {\r\n        //             d3.select('#' + d.idSelector)\r\n        //                 .attr('d', (d: any) => changeObjectSize(d)).transition().duration(50)\r\n        //                 .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz))\r\n        //                 .style('opacity', (d) => {\r\n        //                     return RamachandranComponent.computeOpacity(fillColorFunction(d, drawingType, outliersType, rsrz))\r\n        //                 });\r\n        //         });\r\n        //         highlightedResidues.pop();\r\n        //     }\r\n        //     dispatchCustomEvent('PDB.ramaViewer.click', d);\r\n        //     highlightedResidues.push(d);\r\n        //     d3.select(this)\r\n        //         .attr('d', (d: any) => changeObjectSize(d, false))\r\n        //         .style('fill', 'magenta')\r\n        //         .style('opacity', 1);\r\n        //         // .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n        // });\r\n        RamachandranComponent.outliersList.sort((a, b) => a.num - b.num);\r\n        this.addSummaryInfo();\r\n    }\r\n    /**\r\n     * add baseContours\r\n     * @param {number} ramaContourPlotType\r\n     * @param {number} contourColorStyle\r\n     */\r\n    static baseContours(ramaContourPlotType, contourColorStyle) {\r\n        RamachandranComponent.clearCanvas();\r\n        let width = 500, height = 500;\r\n        if (width > 768) {\r\n            width = 580;\r\n        }\r\n        if (height > 768) {\r\n            height = 580;\r\n        }\r\n        const img = new Image();\r\n        const svgImg = new Image();\r\n        switch (ramaContourPlotType) {\r\n            case 1:\r\n                img.src = HeatMapContours_1.generalContour;\r\n                svgImg.src = LineContours_1.lineGeneralContour;\r\n                break;\r\n            case 2:\r\n                img.src = HeatMapContours_1.ileVal;\r\n                svgImg.src = LineContours_1.lineIleVal;\r\n                break;\r\n            case 3:\r\n                img.src = HeatMapContours_1.prePro;\r\n                svgImg.src = LineContours_1.linePrePro;\r\n                break;\r\n            case 4:\r\n                img.src = HeatMapContours_1.gly;\r\n                svgImg.src = LineContours_1.lineGly;\r\n                break;\r\n            case 5:\r\n                img.src = HeatMapContours_1.transPro;\r\n                svgImg.src = LineContours_1.lineTransPro;\r\n                break;\r\n            case 6:\r\n                img.src = HeatMapContours_1.cisPro;\r\n                svgImg.src = LineContours_1.lineCisPro;\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n        const context = RamachandranComponent.canvasContainer.node().getContext('2d');\r\n        context.clearRect(0, 0, width + 80, height + 60);\r\n        if (contourColorStyle == 2) {\r\n            context.globalAlpha = 0.6;\r\n            img.onload = () => {\r\n                context.drawImage(img, 0, 0, width, height * img.height / img.width);\r\n            };\r\n        }\r\n        else {\r\n            context.globalAlpha = 1;\r\n            svgImg.onload = () => {\r\n                context.drawImage(svgImg, 0, 0, width, height * svgImg.height / svgImg.width);\r\n            };\r\n        }\r\n    }\r\n    /**\r\n     * add listeners from other components\r\n     */\r\n    addEventListeners() {\r\n        const clickEvents = ['PDB.litemol.click', 'PDB.topologyViewer.click'];\r\n        const mouseOutEvents = ['PDB.topologyViewer.mouseout', 'PDB.litemol.mouseout'];\r\n        let scrollTimer, lastScrollFireTime = 0;\r\n        const { fillColorFunction, residueColorStyle, outliersType, rsrz } = this;\r\n        /**\r\n         * unhighlight residue from event\r\n         * @param event\r\n         */\r\n        function unHighlightObject(event) {\r\n            if (typeof event.eventData != 'undefined') {\r\n                if (RamachandranComponent.highlightedResidues.indexOf(getResidueNode(event)) == -1) {\r\n                    d3.select('.selected-res')\r\n                        .classed('selected-res', false)\r\n                        .attr('d', (d) => RamachandranComponent.changeObjectSize(d)).transition().duration(50)\r\n                        .style('fill', (d) => fillColorFunction(d, residueColorStyle, outliersType, rsrz, true))\r\n                        .style('display', 'block');\r\n                    // .style('opacity', (d) => {\r\n                    //     return RamachandranComponent.computeOpacity(fillColorFunction(d, drawingType, outliersType, rsrz))\r\n                    // });\r\n                }\r\n            }\r\n        }\r\n        /**\r\n         * onClick event\r\n         * @param event\r\n         */\r\n        function onClick(event) {\r\n            const res = getResidueNode(event);\r\n            if (RamachandranComponent.highlightedResidues.length != 0) {\r\n                RamachandranComponent.highlightedResidues.forEach((d) => {\r\n                    d.attr('d', (d) => RamachandranComponent.changeObjectSize(d)).transition().duration(50)\r\n                        .style('fill', (dat) => fillColorFunction(dat, residueColorStyle, outliersType, rsrz))\r\n                        .style('display', 'block');\r\n                    // .style('opacity', (d) => {\r\n                    //     return RamachandranComponent.computeOpacity(fillColorFunction(d, drawingType, outliersType, rsrz))\r\n                    // });\r\n                });\r\n                RamachandranComponent.highlightedResidues.pop();\r\n            }\r\n            RamachandranComponent.highlightedResidues.push(res);\r\n            getResidueNode(event).attr('d', (d) => RamachandranComponent.changeObjectSize(d, false))\r\n                .classed('selected-res', false)\r\n                .style('fill', 'magenta')\r\n                .style('opacity', '1');\r\n        }\r\n        /**\r\n         * return residue node from event\r\n         * @param event\r\n         * @returns {any}\r\n         */\r\n        function getResidueNode(event) {\r\n            if (typeof event.eventData.chainId == 'undefined')\r\n                return null;\r\n            return d3.select('path#' +\r\n                event.eventData.residueName + '-' +\r\n                event.eventData.chainId + '-' +\r\n                event.eventData.entityId + '-' +\r\n                event.eventData.residueNumber);\r\n        }\r\n        /**\r\n         * highlight residue from event\r\n         * @param event\r\n         */\r\n        function highLightObject(event) {\r\n            let res = getResidueNode(event);\r\n            if (res) {\r\n                res.attr('d', (d) => RamachandranComponent.changeObjectSize(d, false))\r\n                    .classed('selected-res', true)\r\n                    .style('fill', 'yellow')\r\n                    .style('opacity', '1');\r\n                // .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n            }\r\n        }\r\n        window.addEventListener('PDB.topologyViewer.mouseover', (event) => {\r\n            const minMouseOverTime = 150;\r\n            let now = new Date().getTime();\r\n            function mouseOver(event) {\r\n                if (typeof event.eventData != 'undefined') {\r\n                    let res = getResidueNode(event);\r\n                    if (res) {\r\n                        if (res.attr('style').includes('magenta')) {\r\n                            return;\r\n                        }\r\n                    }\r\n                    unHighlightObject(event);\r\n                    highLightObject(event);\r\n                }\r\n                else {\r\n                    unHighlightObject(event);\r\n                }\r\n            }\r\n            if (!scrollTimer) {\r\n                if (now - lastScrollFireTime > (3 * minMouseOverTime)) {\r\n                    mouseOver(event); // fire immediately on first scroll\r\n                    lastScrollFireTime = now;\r\n                }\r\n                scrollTimer = setTimeout(function () {\r\n                    scrollTimer = null;\r\n                    lastScrollFireTime = new Date().getTime();\r\n                    mouseOver(event);\r\n                }, minMouseOverTime);\r\n            }\r\n        });\r\n        window.addEventListener('PDB.litemol.mouseover', (event) => {\r\n            if (typeof event.eventData != 'undefined') {\r\n                let res = getResidueNode(event);\r\n                if (res) {\r\n                    if (res.attr('style').includes('magenta')) {\r\n                        return;\r\n                    }\r\n                }\r\n                unHighlightObject(event);\r\n                highLightObject(event);\r\n            }\r\n            else {\r\n                unHighlightObject(event);\r\n            }\r\n        });\r\n        window.addEventListener('protvista.click', (d) => {\r\n            RamachandranComponent.hiddenResidues.forEach((dat) => {\r\n                if (dat.idSelector != '') {\r\n                    d3.select(`#${dat.idSelector}`)\r\n                        .style('visibility', 'visible');\r\n                }\r\n            });\r\n            if (this.lastSelection == d.detail) {\r\n                RamachandranComponent.hiddenResidues = [];\r\n                RamachandranComponent.selectedResidues = [];\r\n                this.lastSelection = {};\r\n                return;\r\n            }\r\n            this.lastSelection = d.detail;\r\n            RamachandranComponent.hiddenResidues = RamachandranComponent.residuesOnCanvas.filter((dat) => {\r\n                if (!(dat.authorResNum >= this.lastSelection.begin && dat.authorResNum <= this.lastSelection.end))\r\n                    return dat;\r\n                else\r\n                    RamachandranComponent.selectedResidues.push(dat);\r\n            });\r\n            RamachandranComponent.hiddenResidues.forEach((dat) => {\r\n                if (dat.idSelector != '') {\r\n                    if (d3.select(`#${dat.idSelector}`).empty()) {\r\n                        return;\r\n                    }\r\n                    d3.select(`#${dat.idSelector}`).style('visibility', 'hidden');\r\n                }\r\n            });\r\n        });\r\n        /**\r\n         * add event listeners\r\n         */\r\n        clickEvents.forEach((type) => {\r\n            window.addEventListener(type, (event) => {\r\n                onClick(event);\r\n            });\r\n        });\r\n        mouseOutEvents.forEach((type) => {\r\n            window.addEventListener(type, (event) => {\r\n                if (RamachandranComponent.highlightedResidues.indexOf(event) > -1) {\r\n                    return;\r\n                }\r\n                unHighlightObject(event);\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * add summary infobelow the plot\r\n     */\r\n    addSummaryInfo() {\r\n        switch (this.residueColorStyle) {\r\n            case 1:\r\n                d3.selectAll('#rama-sum-div').remove();\r\n                d3.select('#rama-sum').append('div').attr('id', 'rama-sum-div')\r\n                    .append('div').attr('class', 'rama-sum-cell').attr('id', 'rama-sum-widest')\r\n                    .text('Preferred regions: ' + String(RamachandranComponent.favored)\r\n                    + ' (' + String((RamachandranComponent.favored / RamachandranComponent.jsonObject.length * 100).toFixed(0))\r\n                    + '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-middle')\r\n                    .text('Allowed regions: ' + String(RamachandranComponent.allowed)\r\n                    + ' (' + String((RamachandranComponent.allowed / RamachandranComponent.jsonObject.length * 100).toFixed(0))\r\n                    + '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-thinnest')\r\n                    .text('Outliers: ' + String(RamachandranComponent.outliersList.length)\r\n                    + ' (' + String((RamachandranComponent.outliersList.length / RamachandranComponent.jsonObject.length * 100).toFixed(0)) + '%)').enter();\r\n                break;\r\n            case 2:\r\n                d3.selectAll('#rama-sum-div').remove();\r\n                d3.select('#rama-sum').append('div').attr('id', 'rama-sum-div')\r\n                    .append('div').attr('class', 'rama-sum-cell').attr('id', 'rama-sum-widest')\r\n                    .text('Ramachandran outliers: ' + String(this.ramachandranOutliers)\r\n                    + ' (' + String((this.ramachandranOutliers / RamachandranComponent.jsonObject.length * 100).toFixed(0)) +\r\n                    '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-middle')\r\n                    .text('Sidechain outliers: ' + String(this.sidechainOutliers)\r\n                    + ' (' + String((this.sidechainOutliers / RamachandranComponent.jsonObject.length * 100).toFixed(0)) + '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-thinnest')\r\n                    .text('Clashes: ' + String(this.clashes)\r\n                    + ' (' + String((this.clashes / RamachandranComponent.jsonObject.length * 100).toFixed(0)) + '%)').enter();\r\n                break;\r\n            case 3:\r\n                d3.selectAll('#rama-sum-div').remove();\r\n                d3.select('#rama-sum').append('div').attr('id', 'rama-sum-div')\r\n                    .append('div').attr('class', 'rama-sum-cell').attr('id', 'rama-sum-widest')\r\n                    .text('RSRZ: ' + String(this.rsrzCount)\r\n                    + ' (' + String((this.rsrzCount / RamachandranComponent.jsonObject.length * 100).toFixed(0)) + '%) ').enter();\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n    }\r\n    /**\r\n     * compute summary stats of ramachandran diagram\r\n     * @param d\r\n     */\r\n    computeStats(d) {\r\n        if (this.outliersType[d.num] != undefined) {\r\n            if (this.outliersType[d.num].outliersType.includes('clashes')) {\r\n                this.clashes++;\r\n            }\r\n            if (this.outliersType[d.num].outliersType.includes('ramachandran_outliers')) {\r\n                this.ramachandranOutliers++;\r\n            }\r\n            if (this.outliersType[d.num].outliersType.includes('sidechain_outliers')) {\r\n                this.sidechainOutliers++;\r\n            }\r\n        }\r\n        if (typeof this.rsrz[d.num] != 'undefined') {\r\n            this.rsrzCount++;\r\n        }\r\n    }\r\n    /**\r\n     * return fillColor which will be used\r\n     * @param d - one residue\r\n     * @param {number} drawingType Default - 1/Quality - 2/ RSRZ - 3\r\n     * @param outliersType\r\n     * @param rsrz\r\n     * @param {boolean} compute\r\n     * @returns {string} hex of color\r\n     */\r\n    fillColorFunction(d, drawingType, outliersType, rsrz, compute = false) {\r\n        if (compute)\r\n            this.computeStats(d);\r\n        switch (drawingType) {\r\n            case 1:\r\n                if (d.rama === 'OUTLIER') {\r\n                    return '#f00';\r\n                }\r\n                return 'black';\r\n            case 2:\r\n                if (typeof outliersType[d.num] === 'undefined') {\r\n                    return '#008000';\r\n                }\r\n                else {\r\n                    switch (outliersType[d.num].outliersType.length) {\r\n                        case 0:\r\n                            return '#008000';\r\n                        case 1:\r\n                            return '#ff0';\r\n                        case 2:\r\n                            return '#f80';\r\n                        default:\r\n                            return '#850013';\r\n                    }\r\n                }\r\n            case 3:\r\n                if (typeof rsrz[d.num] === 'undefined') {\r\n                    return 'black';\r\n                }\r\n                else {\r\n                    return '#f00';\r\n                }\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    /**\r\n     * how opaque node will be\r\n     * @param fillTmp\r\n     * @returns {number}\r\n     */\r\n    static computeOpacity(fillTmp) {\r\n        if (fillTmp === '#008000' || fillTmp === 'black') {\r\n            return 0.15;\r\n        }\r\n        if (fillTmp === '#ff0') {\r\n            return 0.8;\r\n        }\r\n        return 1;\r\n    }\r\n    /**\r\n     * return timeoutid when hovering\r\n     * @param {number} ramaContourPlotType\r\n     * @param {string} aa\r\n     * @returns {number}\r\n     */\r\n    static getTimeout(ramaContourPlotType, aa = '') {\r\n        return window.setTimeout(() => {\r\n            RamachandranComponent.baseContours(ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n            RamachandranComponent.changeOpacity(aa);\r\n        }, 600);\r\n    }\r\n    /**\r\n     * throw new event with defined data\r\n     * @param {string} name name of event\r\n     * @param {string} pdbId\r\n     * @param d node\r\n     */\r\n    static dispatchCustomEvent(name, d, pdbId) {\r\n        const event = new CustomEvent(name, { detail: {\r\n                chainId: d.chain,\r\n                entityId: d.modelId,\r\n                entry: pdbId,\r\n                residueName: d.aa,\r\n                residueNumber: d.num\r\n            } });\r\n        window.dispatchEvent(event);\r\n    }\r\n    /**\r\n     * function for change contours after mouseout or mouseover\r\n     * @param data selected node\r\n     * @param toDefault true if used for return to base state\r\n     * @param ramaContourPlotType\r\n     */\r\n    static changeContours(data, toDefault = true, ramaContourPlotType) {\r\n        RamachandranComponent.currentTime = new Date().getTime();\r\n        switch (data.aa) {\r\n            case 'ILE':\r\n            case 'VAL':\r\n                if (ramaContourPlotType != 2) {\r\n                    if (toDefault) {\r\n                        RamachandranComponent.baseContours(ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n                        RamachandranComponent.changeOpacity('VAL,ILE', false);\r\n                    }\r\n                    else {\r\n                        RamachandranComponent.timeoutId = RamachandranComponent.getTimeout(2, 'VAL,ILE');\r\n                    }\r\n                }\r\n                return;\r\n            case 'GLY':\r\n                if (ramaContourPlotType != 4) {\r\n                    if (toDefault) {\r\n                        RamachandranComponent.baseContours(ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n                        RamachandranComponent.changeOpacity('GLY', false);\r\n                    }\r\n                    else {\r\n                        RamachandranComponent.timeoutId = RamachandranComponent.getTimeout(4, 'GLY');\r\n                    }\r\n                }\r\n                return;\r\n            case 'PRO':\r\n                if (ramaContourPlotType < 5) {\r\n                    if (toDefault) {\r\n                        RamachandranComponent.baseContours(ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n                        RamachandranComponent.changeOpacity('PRO', false);\r\n                    }\r\n                    else {\r\n                        if (data.cisPeptide === null && data.aa === 'PRO') {\r\n                            RamachandranComponent.timeoutId = RamachandranComponent.getTimeout(5, 'PRO');\r\n                            break;\r\n                        }\r\n                        if (data.cisPeptide === 'Y' && data.aa === 'PRO') {\r\n                            RamachandranComponent.timeoutId = RamachandranComponent.getTimeout(6, 'PRO');\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                return;\r\n            default:\r\n                break;\r\n        }\r\n        switch (data.prePro) {\r\n            case true:\r\n                if (ramaContourPlotType != 3) {\r\n                    if (toDefault) {\r\n                        RamachandranComponent.baseContours(ramaContourPlotType, RamachandranComponent.contourColoringStyle);\r\n                        RamachandranComponent.changeOpacity('', false);\r\n                    }\r\n                    else {\r\n                        RamachandranComponent.timeoutId = RamachandranComponent.getTimeout(3, '');\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    /**\r\n     * text for tooltip\r\n     * @param d\r\n     * @returns {string}\r\n     */\r\n    static tooltipText(d) {\r\n        // language=HTML\r\n        return `<b>${d.chain} ${d.num} ${d.aa}</b><br/>\\u03A6: ${d.phi}<br/>\\u03A8: ${d.psi}`;\r\n    }\r\n    /**\r\n     * change object size on hover\r\n     * @param d\r\n     * @param {boolean} smaller\r\n     * @returns {string | null}\r\n     */\r\n    static changeObjectSize(d, smaller = true) {\r\n        let objSize = 40;\r\n        if (window.screen.availWidth < 1920) {\r\n            objSize = 30;\r\n        }\r\n        if (window.screen.width < 350) {\r\n            objSize = 5;\r\n        }\r\n        let size = 175;\r\n        if (smaller) {\r\n            size = objSize;\r\n        }\r\n        if (d.aa === 'GLY') {\r\n            RamachandranComponent.symbolTypes.triangle.size(size);\r\n            return RamachandranComponent.symbolTypes.triangle();\r\n        }\r\n        RamachandranComponent.symbolTypes.circle.size(size);\r\n        return RamachandranComponent.symbolTypes.circle();\r\n    }\r\n    /**\r\n     *\r\n     * @param d\r\n     * @param {string} pdbId\r\n     * @param {number} ramaContourPlotType\r\n     * @param {number} residueColorStyle\r\n     * @param tooltip\r\n     * @param outliersType\r\n     * @param rsrz\r\n     */\r\n    onMouseOverResidue(d, pdbId, ramaContourPlotType, residueColorStyle, tooltip, outliersType, rsrz) {\r\n        let highlightColor = 'yellow';\r\n        RamachandranComponent.dispatchCustomEvent('PDB.ramaViewer.mouseOver', d, pdbId);\r\n        RamachandranComponent.changeContours(d, false, ramaContourPlotType);\r\n        switch (residueColorStyle) {\r\n            case 1:\r\n                if (d.rama === 'Favored') {\r\n                    tooltip.html(RamachandranComponent.tooltipText(d) + '<br/> Favored');\r\n                }\r\n                if (d.rama === 'Allowed') {\r\n                    tooltip.html(RamachandranComponent.tooltipText(d) + '<br/> Allowed');\r\n                }\r\n                if (d.rama === 'OUTLIER') {\r\n                    tooltip.html(RamachandranComponent.tooltipText(d) + '<br/><b>OUTLIER</b>');\r\n                }\r\n                break;\r\n            case 2:\r\n                let tempStr = '';\r\n                highlightColor = 'magenta';\r\n                if (typeof outliersType[d.num] === 'undefined') {\r\n                    tooltip.html(RamachandranComponent.tooltipText(d));\r\n                    break;\r\n                }\r\n                if (outliersType[d.num].outliersType.includes('clashes')) {\r\n                    tempStr += '<br/>Clash';\r\n                }\r\n                if (outliersType[d.num].outliersType.includes('ramachandran_outliers')) {\r\n                    tempStr += '<br/>Ramachandran outlier';\r\n                    RamachandranComponent.tooltipWidth = 130;\r\n                }\r\n                if (outliersType[d.num].outliersType.includes('sidechain_outliers')) {\r\n                    tempStr += '<br/>Sidechain outlier';\r\n                    RamachandranComponent.tooltipWidth = 100;\r\n                }\r\n                if (outliersType[d.num].outliersType.includes('bond_angles')) {\r\n                    tempStr += '<br/>Bond angles';\r\n                }\r\n                else {\r\n                    tooltip.html(RamachandranComponent.tooltipText(d));\r\n                }\r\n                switch (outliersType[d.num].outliersType.length) {\r\n                    case 2:\r\n                        RamachandranComponent.tooltipHeight = 68;\r\n                        break;\r\n                    case 3:\r\n                        RamachandranComponent.tooltipHeight = 78;\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                tooltip.html(RamachandranComponent.tooltipText(d) + tempStr);\r\n                break;\r\n            case 3:\r\n                if (typeof rsrz[d.num] === 'undefined') {\r\n                    tooltip.html(RamachandranComponent.tooltipText(d));\r\n                }\r\n                else {\r\n                    tooltip.html(RamachandranComponent.tooltipText(d) + '<br/><b>RSRZ outlier</b>');\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        tooltip.transition()\r\n            .style('opacity', .95)\r\n            .style('left', (d3.event.pageX + 10) + 'px')\r\n            .style('top', (d3.event.pageY - 48) + 'px')\r\n            .style('height', RamachandranComponent.tooltipHeight)\r\n            .style('width', String(RamachandranComponent.tooltipWidth) + 'px');\r\n        d3.select(`#${d.idSelector}`)\r\n            .attr('d', (d) => RamachandranComponent.changeObjectSize(d, false))\r\n            .style('fill', highlightColor)\r\n            .style('opacity', 1);\r\n        // .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n    }\r\n    /**\r\n     *\r\n     * @param d\r\n     * @param pdbId\r\n     * @param {number} ramaContourPlotType\r\n     * @param {number} residueColorStyle\r\n     * @param tooltip\r\n     * @param outliersType\r\n     * @param rsrz\r\n     * @param fillColorFunction\r\n     */\r\n    onMouseOutResidue(d, pdbId, ramaContourPlotType, residueColorStyle, tooltip, outliersType, rsrz, fillColorFunction) {\r\n        let outTime = new Date().getTime();\r\n        RamachandranComponent.dispatchCustomEvent('PDB.ramaViewer.mouseOut', d, pdbId);\r\n        if (RamachandranComponent.highlightedResidues.indexOf(d) > -1) {\r\n            return;\r\n        }\r\n        d3.select(`#${d.idSelector}`)\r\n            .transition()\r\n            .attr('d', (dat) => RamachandranComponent.changeObjectSize(dat))\r\n            .style('fill', (d) => fillColorFunction(d, residueColorStyle, outliersType, rsrz))\r\n            .style('opacity', (d) => {\r\n            return RamachandranComponent.computeOpacity(fillColorFunction(d, residueColorStyle, outliersType, rsrz));\r\n        });\r\n        tooltip.transition()\r\n            .style('opacity', 0);\r\n        console.log(outTime - RamachandranComponent.currentTime);\r\n        if ((outTime - RamachandranComponent.currentTime) > 600) {\r\n            window.setTimeout(() => {\r\n                RamachandranComponent.changeContours(d, true, ramaContourPlotType);\r\n            }, 50);\r\n        }\r\n    }\r\n    /**\r\n     * change residue coloring\r\n     * @param {number} residueColorStyle\r\n     */\r\n    changeResiduesColors(residueColorStyle) {\r\n        let { tooltip, outliersType, rsrz, onMouseOverResidue, pdbId, ramaContourPlotType, fillColorFunction, onMouseOutResidue } = this;\r\n        let resArray = RamachandranComponent.jsonObject.slice(0);\r\n        if (RamachandranComponent.selectedResidues.length != 0) {\r\n            resArray = RamachandranComponent.selectedResidues.slice(0);\r\n        }\r\n        resArray.forEach((d) => {\r\n            if (d.idSelector != '') {\r\n                const node = d3.select(`#${d.idSelector}`);\r\n                node.style('fill', this.fillColorFunction(d, residueColorStyle, this.outliersType, this.rsrz));\r\n                node.style('opacity', (d) => {\r\n                    return RamachandranComponent.computeOpacity(this.fillColorFunction(d, residueColorStyle, this.outliersType, this.rsrz));\r\n                });\r\n                node.on('mouseover', function () {\r\n                    if (d3.select(`#${d.idSelector}`).style('opacity') == '0')\r\n                        return;\r\n                    onMouseOverResidue(d, pdbId, ramaContourPlotType, residueColorStyle, tooltip, outliersType, rsrz);\r\n                });\r\n                node.on('mouseout', function () {\r\n                    if (d3.select(`#${d.idSelector}`).style('opacity') == '0')\r\n                        return;\r\n                    window.clearTimeout(RamachandranComponent.timeoutId);\r\n                    onMouseOutResidue(d, pdbId, ramaContourPlotType, residueColorStyle, tooltip, outliersType, rsrz, fillColorFunction);\r\n                });\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * sort json object to that it can be better displayed\r\n     * @param jsonObject\r\n     * @param {number} drawingType\r\n     * @param {any[]} outliersType\r\n     * @param {any[]} rsrz\r\n     */\r\n    sortJson(jsonObject, drawingType, outliersType, rsrz) {\r\n        jsonObject.sort((a, b) => {\r\n            // switch (drawingType) {\r\n            //     case 1:\r\n            //         if (a.rama === 'OUTLIER') {\r\n            //             if (b.rama === 'Allowed') {\r\n            //                 return 1;\r\n            //             }\r\n            //             if (b.rama === 'Favored') {\r\n            //                 return 1;\r\n            //             }\r\n            //             if (b.rama === 'OUTLIER') {\r\n            //                 return 0;\r\n            //             }\r\n            //         }\r\n            //         if (a.rama === 'Allowed') {\r\n            //             if (b.rama === 'Allowed') {\r\n            //                 return 0;\r\n            //             }\r\n            //             if (b.rama === 'Favored') {\r\n            //                 return 1;\r\n            //             }\r\n            //             if (b.rama === 'OUTLIER') {\r\n            //                 return -1;\r\n            //             }\r\n            //         }\r\n            //         if (a.rama === 'Favored') {\r\n            //             if (b.rama === 'Allowed') {\r\n            //                 return -1;\r\n            //             }\r\n            //             if (b.rama === 'Favored') {\r\n            //                 return 0;\r\n            //             }\r\n            //             if (b.rama === 'OUTLIER') {\r\n            //                 return -1;\r\n            //             }\r\n            //         }\r\n            //         break;\r\n            //     case 2:\r\n            if (typeof rsrz[a.num] != 'undefined') {\r\n                return 1;\r\n            }\r\n            else if (typeof rsrz[b.num] != 'undefined') {\r\n                return -1;\r\n            }\r\n            else if (typeof outliersType[a.num] == 'undefined') {\r\n                return -1;\r\n            }\r\n            else if (typeof outliersType[b.num] == 'undefined') {\r\n                return 1;\r\n            }\r\n            else if (outliersType[a.num].outliersType.length > outliersType[b.num].outliersType.length) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n            //     case 3:\r\n            //         if (typeof rsrz[a.num] === 'undefined') {\r\n            //             return -1;\r\n            //         } else if (typeof  rsrz[b.num] === 'undefined') {\r\n            //             return 1;\r\n            //         } else {\r\n            //             return 1;\r\n            //         }\r\n            //     default:\r\n            //         break;\r\n            // }\r\n        });\r\n    }\r\n    /**\r\n     * function to change opacity while hovering\r\n     * @param {string} aa\r\n     * @param {boolean} makeInvisible\r\n     */\r\n    static changeOpacity(aa, makeInvisible = true) {\r\n        let residues = aa.split(',');\r\n        let nodes;\r\n        let resArray = RamachandranComponent.jsonObject.slice(0);\r\n        if (RamachandranComponent.selectedResidues.length != 0) {\r\n            resArray = RamachandranComponent.selectedResidues.slice(0);\r\n        }\r\n        if (aa == '') {\r\n            nodes = resArray.filter((d) => {\r\n                return d.prePro == false;\r\n            });\r\n        }\r\n        else if (residues.length > 1) {\r\n            nodes = resArray.filter((d) => {\r\n                return (residues.indexOf(d.aa) == -1);\r\n            });\r\n        }\r\n        else {\r\n            nodes = resArray.filter((d) => {\r\n                return (d.aa != aa);\r\n            });\r\n        }\r\n        nodes.forEach((d) => {\r\n            if (d.idSelector == '')\r\n                return;\r\n            let node = d3.select(`#${d.idSelector}`);\r\n            if (makeInvisible)\r\n                // node.style('opacity', 0);\r\n                node.style('display', 'none');\r\n            else {\r\n                node.style('display', 'block');\r\n                // const selection: any = node.node();\r\n                // if (selection.style.fill == 'rgb(0, 128, 0)'\r\n                //     || selection.style.fill == 'black'\r\n                //     || selection.style.fill == 'rgb(0, 0, 0)') {\r\n                //     selection.style.opacity = 0.15;\r\n                //\r\n                // } else if (selection.style.fill == 'rgb(255, 255, 0)') {\r\n                //     selection.style.opacity = 0.8;\r\n                // }else {\r\n                //     selection.style.opacity = 1;\r\n                // }\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * clearContourCanvas\r\n     */\r\n    static clearCanvas() {\r\n        d3.select('#rama-canvas').empty();\r\n        d3.selectAll('.contour-line').remove();\r\n    }\r\n    /**\r\n     * add outliers table\r\n     */\r\n    addTable() {\r\n        this.outliersTable = d3.select('.outliers-container').append('div')\r\n            .attr('class', 'outliers').append('table')\r\n            .attr('class', 'table table-hover table-responsive');\r\n        d3.select('.outliers-container').append('table')\r\n            .attr('class', 'rama-outliers-table').append('thead').append('tr').attr('id', 'tab-headline');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('Chain')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('ID')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('AA')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('Phi')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('Psi')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n    }\r\n    /**\r\n     * fill outliers table\r\n     * @param {any[]} sortedTable\r\n     * @param {number} drawingType\r\n     */\r\n    fillTable(sortedTable, drawingType) {\r\n        let objSize = 40;\r\n        const { fillColorFunction, outliersType, rsrz } = this;\r\n        if (window.screen.availWidth < 1920) {\r\n            objSize = 30;\r\n        }\r\n        if (window.screen.width < 350) {\r\n            objSize = 5;\r\n        }\r\n        const symbolTypes = {\r\n            circle: d3.symbol().type(d3.symbolCircle).size(30),\r\n            triangle: d3.symbol().type(d3.symbolTriangle).size(30)\r\n        };\r\n        const rows = this.outliersTable.selectAll('tbody tr')\r\n            .data(sortedTable, (d) => d.num);\r\n        rows.enter()\r\n            .append('tr')\r\n            .on('mouseover', function (d) {\r\n            d3.select(this)\r\n                .style('background-color', '#b4bed6')\r\n                .style('cursor', 'pointer');\r\n            d3.select('#' + '-' + d.chain + '-' + d.modelId + '-' + d.num)\r\n                .attr('d', (dat) => {\r\n                if (dat.aa === 'GLY') {\r\n                    symbolTypes.triangle.size(175);\r\n                    return symbolTypes.triangle();\r\n                }\r\n                symbolTypes.circle.size(175);\r\n                return symbolTypes.circle();\r\n            })\r\n                .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n        })\r\n            //\r\n            .on('mouseout', function (d) {\r\n            d3.select(this)\r\n                .style('background-color', 'transparent')\r\n                .style('cursor', 'default');\r\n            d3.select('#' + d.aa + '-' + d.chain + '-' + d.modelId + '-' + d.num)\r\n                .transition()\r\n                // .duration(50)\r\n                .attr('d', (dat) => {\r\n                if (dat.aa === 'GLY') {\r\n                    symbolTypes.triangle.size(objSize);\r\n                    return symbolTypes.triangle();\r\n                }\r\n                symbolTypes.circle.size(objSize);\r\n                return symbolTypes.circle();\r\n            })\r\n                .style('fill', (d) => fillColorFunction(d, drawingType, outliersType, rsrz))\r\n                .style('fillColorFunction-width', '0.5');\r\n        })\r\n            .selectAll('td')\r\n            .data((d) => [d.chain, d.num, d.aa, d.phi, d.psi])\r\n            .enter()\r\n            .append('td')\r\n            .attr('id', 'rama-td')\r\n            .style('width', '30%')\r\n            .style('min-width', '50px')\r\n            .style('text-align', 'right')\r\n            .text((d) => d);\r\n        rows.exit().remove();\r\n        //\r\n        const cells = rows.selectAll('td')\r\n            .data((d) => [d.chain, d.num, d.aa, d.phi, d.psi])\r\n            .text((d) => d);\r\n        //\r\n        cells.enter()\r\n            .append('td')\r\n            .text((d) => d);\r\n        cells.exit().remove();\r\n    }\r\n}\r\nwindow.customElements.define('ramachandran-component', RamachandranComponent);\r\nndow.customElements.define('ramachandran-component', RamachandranComponent);\r\n"]}