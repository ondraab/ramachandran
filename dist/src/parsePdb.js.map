{"version":3,"sources":["../../src/parsePdb.js"],"names":["Object","defineProperty","exports","value","Res","_residueColor","_prePro","_num","_aa","aa","phi","psi","rama","chain","num","cisPeptide","modelId","authorResNum","idSelector","ParsePDB","pdb","_rsrz","_outlDict","pdbID","toLowerCase","_moleculs","_chainsArray","_modelArray","_residueArray","xmlHttp","XMLHttpRequest","open","send","status","molecules","JSON","parse","responseText","mol","chains","models","mod","chainsArray","indexOf","chain_id","push","modelArray","model_id","residues","resid","residue_name","residue_number","cis_peptide","author_residue_number","residueArray","sort","a","b","forEach","index","length","prePro","mols","res","outlier_types","outliersType","default"],"mappings":"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","file":"parsePdb.js","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Res {\r\n    get residueColor() {\r\n        return this._residueColor;\r\n    }\r\n    set residueColor(value) {\r\n        this._residueColor = value;\r\n    }\r\n    get prePro() {\r\n        return this._prePro;\r\n    }\r\n    get num() {\r\n        return this._num;\r\n    }\r\n    set num(value) {\r\n        this._num = value;\r\n    }\r\n    get aa() {\r\n        return this._aa;\r\n    }\r\n    set aa(value) {\r\n        this._aa = value;\r\n    }\r\n    set prePro(value) {\r\n        this._prePro = value;\r\n    }\r\n    constructor(aa, phi, psi, rama, chain, num, cisPeptide, modelId, authorResNum) {\r\n        this._aa = aa;\r\n        this.phi = phi;\r\n        this.psi = psi;\r\n        this.rama = rama;\r\n        this.chain = chain;\r\n        this._num = num;\r\n        this.cisPeptide = cisPeptide;\r\n        this.modelId = modelId;\r\n        this._residueColor = '';\r\n        this.idSelector = '';\r\n        this._prePro = false;\r\n        this.authorResNum = authorResNum;\r\n    }\r\n}\r\nclass ParsePDB {\r\n    constructor(pdb) {\r\n        this._rsrz = {};\r\n        this._outlDict = {};\r\n        this.pdbID = pdb.toLowerCase();\r\n        this._moleculs = [];\r\n        this._chainsArray = [];\r\n        this._modelArray = [];\r\n        this._residueArray = [];\r\n    }\r\n    get moleculs() {\r\n        return this._moleculs;\r\n    }\r\n    downloadAndParse() {\r\n        const xmlHttp = new XMLHttpRequest();\r\n        xmlHttp.open('GET', 'https://www.ebi.ac.uk/pdbe/api/validation/rama_sidechain_listing/entry/' + this.pdbID, false);\r\n        xmlHttp.send();\r\n        if (xmlHttp.status !== 200) {\r\n            return;\r\n        }\r\n        else {\r\n            const molecules = JSON.parse(xmlHttp.responseText)[this.pdbID];\r\n            for (const mol of molecules.molecules) {\r\n                for (const chain of mol.chains) {\r\n                    for (const mod of chain.models) {\r\n                        if (this.chainsArray.indexOf(chain.chain_id) === -1) {\r\n                            this.chainsArray.push(chain.chain_id);\r\n                        }\r\n                        if (this.modelArray.indexOf(mod.model_id) === -1) {\r\n                            this._modelArray.push(mod.model_id);\r\n                        }\r\n                        for (const resid of mod.residues) {\r\n                            this._residueArray.push(new Res(resid.residue_name, resid.phi, resid.psi, resid.rama, chain.chain_id, resid.residue_number, resid.cis_peptide, mod.model_id, resid.author_residue_number));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this.residueArray.sort((a, b) => {\r\n                if (a.num < b.num)\r\n                    return -1;\r\n                if (a.num > b.num)\r\n                    return 1;\r\n                return 0;\r\n            });\r\n            this.residueArray.forEach((value, index) => {\r\n                if (index + 1 != this.residueArray.length) {\r\n                    if (this.residueArray[index + 1].num - value.num == 1) {\r\n                        if (this.residueArray[index + 1].aa == 'PRO') {\r\n                            value.prePro = true;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            xmlHttp.open('GET', 'https://www.ebi.ac.uk/pdbe/api/validation/residuewise_outlier_summary/entry/' + this.pdbID, false);\r\n            xmlHttp.send();\r\n            const mols = JSON.parse(xmlHttp.responseText)[this.pdbID];\r\n            for (const mol of mols.molecules) {\r\n                for (const chain of mol.chains) {\r\n                    for (const mod of chain.models) {\r\n                        for (const res of mod.residues) {\r\n                            if (res.outlier_types[0] === 'RSRZ') {\r\n                                this._rsrz[res.residue_number] = { outliersType: res.outlier_types };\r\n                            }\r\n                            else {\r\n                                this._outlDict[res.residue_number] = { outliersType: res.outlier_types };\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    get chainsArray() {\r\n        return this._chainsArray;\r\n    }\r\n    get modelArray() {\r\n        return this._modelArray;\r\n    }\r\n    get residueArray() {\r\n        return this._residueArray;\r\n    }\r\n    get rsrz() {\r\n        return this._rsrz;\r\n    }\r\n    get outlDict() {\r\n        return this._outlDict;\r\n    }\r\n}\r\nexports.ParsePDB = ParsePDB;\r\nexports.default = ParsePDB;\r\n"]}