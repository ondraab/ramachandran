{"version":3,"sources":["../../src/RamachandranComponent.js"],"names":["Object","defineProperty","exports","value","d3","require","polymer_element_js_1","HeatMapContours_1","LineContours_1","parsePdb_1","RamaScatter","createChart","bind","fillColorFunction","pdb","default","pdbId","downloadAndParse","jsonObject","residueArray","outliersType","outlDict","rsrz","ramachandranOutliers","sidechainOutliers","ramaContourPlotType","contourColoringStyle","rsrzCount","clashes","firstRun","highlightedResidues","modelsToShow","forEach","d","parseInt","width","height","xScale","scaleLinear","domain","range","xBottomAxis","axisBottom","xTopAxis","axisTop","xValue","xMap","tooltip","select","append","attr","style","yScale","yLeftAxis","axisLeft","yRightAxis","axisRight","yValue","yMap","makeYGridlines","makeXGridlines","svgContainer","classed","canvasContainer","call","tickSize","text","selectAll","remove","colorSelect","on","filteringChange","plotTypeSelect","plotTypeChanged","ramaForm","coloringChanged","updateChart","chainsToShow","residueColorStyle","basicContours","property","drawingType","compute","rama","num","includes","length","entityToShow","objSize","window","screen","availWidth","outliersList","symbolTypes","circle","symbol","type","symbolCircle","size","triangle","symbolTriangle","switchPlotType","i","aa","cisPeptide","tooltipText","chain","phi","psi","compare","a","b","sort","favored","allowed","outliersTable","dispatchCustomEvent","name","event","CustomEvent","detail","chainId","entityId","modelId","entry","residueName","residueNumber","dispatchEvent","console","log","data","filter","indexOf","enter","id","idSlector","push","merge","fillTmp","html","tempStr","transition","pageX","pageY","String","changeObjectSize","dat","unHighlightObject","toFixed","smaller","all","_idSlector","duration","pop","each","getRes","eventData","residuesName","highLightObject","addEventListener","res","contourType","empty","canvas","img","Image","svgImg","src","generalContour","lineGeneralContour","ileVal","lineIleVal","prePro","linePrePro","gly","lineGly","transPro","lineTransPro","cisPro","lineCisPro","context","node","getContext","clearRect","globalAlpha","onload","drawImage","sortedTable","rows","exit","cells","reflectToAttribute","Array","Number","element","HTMLElement","PolymerElement","customElements","define"],"mappings":"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,uBAAOmB,MAAP,GAAgB,YAAM;AAClBL,4BAAQM,SAAR,CAAkBpB,MAAlB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgCnI,KAAhC,EAAuCC,SAASkI,OAAOlI,MAAhB,GAAyBkI,OAAOnI,KAAvE;AACH,iBAFD;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACH;AACJ;;;iCACQwJ,W,EAAa1G,W,EAAa;AAC/B,gBAAIO,UAAU,EAAd;AAD+B,gBAEvB3E,iBAFuB,GAEmB,IAFnB,CAEvBA,iBAFuB;AAAA,gBAEJO,YAFI,GAEmB,IAFnB,CAEJA,YAFI;AAAA,gBAEUE,IAFV,GAEmB,IAFnB,CAEUA,IAFV;;AAG/B,gBAAImE,OAAOC,MAAP,CAAcC,UAAd,GAA2B,IAA/B,EAAq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","file":"RamachandranComponent.js","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst d3 = require(\"d3\");\r\nconst polymer_element_js_1 = require(\"@polymer/polymer/polymer-element.js\");\r\nconst HeatMapContours_1 = require(\"../contours/HeatMapContours\");\r\nconst LineContours_1 = require(\"../contours/LineContours\");\r\nrequire(\"bootstrap/dist/css/bootstrap.css\");\r\nrequire(\"../public/index.css\");\r\nconst parsePdb_1 = require(\"./parsePdb\");\r\nclass RamaScatter extends polymer_element_js_1.PolymerElement {\r\n    constructor() {\r\n        super();\r\n        // this.pdbId = '1tqn';\r\n        // console.log(this.pdbId);\r\n        this.createChart = this.createChart.bind(this);\r\n        // const pdb = new ParsePDB(this.pdbId);\r\n        // pdb.downloadAndParse();\r\n        //\r\n        // this.jsonObject = pdb.residueArray;\r\n        // this.outliersType = pdb.outlDict;\r\n        // this.rsrz = pdb.rsrz;\r\n        //\r\n        // this.ramachandranOutliers = 0;\r\n        // this.sidechainOutliers = 0;\r\n        // this.rsrzCount = 0;\r\n        // this.clashes = 0;\r\n        // this.firstRun = true;\r\n        // this.highlightedResidues = [];\r\n        // this.createChart();\r\n        // this.state = {\r\n        //     chainsToShow: ['A'],\r\n        //     contourColoringStyle: 1,\r\n        //     element: this.props.element,\r\n        //     initial: true,\r\n        //     modelsToShow: [1],\r\n        //     pdb: this.props.pdbID,\r\n        //     ramaContourPlotType: this.props.ramaContourPlotType,\r\n        //     residueColorStyle: 1,\r\n        // };\r\n        this.fillColorFunction = this.fillColorFunction.bind(this);\r\n    }\r\n    connectedCallback() {\r\n        const pdb = new parsePdb_1.default(this.pdbId);\r\n        pdb.downloadAndParse();\r\n        this.jsonObject = pdb.residueArray;\r\n        this.outliersType = pdb.outlDict;\r\n        this.rsrz = pdb.rsrz;\r\n        this.ramachandranOutliers = 0;\r\n        this.sidechainOutliers = 0;\r\n        this.ramaContourPlotType = 1;\r\n        this.contourColoringStyle = 1;\r\n        this.contourColoringStyle = 1;\r\n        this.rsrzCount = 0;\r\n        this.clashes = 0;\r\n        this.firstRun = true;\r\n        this.highlightedResidues = [];\r\n        this.createChart();\r\n        this.modelsToShow.forEach((d) => {\r\n            d = parseInt(d);\r\n        });\r\n    }\r\n    static get properties() {\r\n        return {\r\n            pdbId: {\r\n                type: String,\r\n                reflectToAttribute: true\r\n            },\r\n            chainsToShow: {\r\n                type: Array,\r\n                reflectToAttribute: true\r\n            },\r\n            modelsToShow: {\r\n                type: Array,\r\n                reflectToAttribute: true\r\n            },\r\n            residueColorStyle: {\r\n                type: Number,\r\n                reflectToAttribute: true\r\n            },\r\n            contourColoringStyle: {\r\n                type: Number,\r\n                reflectToAttribute: true\r\n            },\r\n            ramaContourPlotType: {\r\n                type: Number,\r\n                reflectToAttribute: true\r\n            },\r\n            element: {\r\n                type: HTMLElement,\r\n                reflectToAttribute: true\r\n            },\r\n        };\r\n    }\r\n    static get template() {\r\n        return null;\r\n    }\r\n    // public componentWillUpdate(nextProps: any, nextState: any) {\r\n    //\r\n    //     if (nextProps.pdbID !== this.state.pdb || nextProps.chainsToShow !== this.state.chainsToShow ||\r\n    //         nextProps.modelsToShow !== this.state.modelsToShow) {\r\n    //         this.updateChart(nextProps.chainsToShow, nextProps.ramaContourPlotType, nextProps.modelsToShow,\r\n    //             nextProps.residueColorStyle);\r\n    //         // console.log(nextProps.contourColoringStyle, this.state.contourColoringStyle);\r\n    //     }\r\n    //     if (nextProps.ramaContourPlotType !== this.state.ramaContourPlotType) {\r\n    //         // this.updateChart(nextProps.chainsToShow, nextProps.ramaContourPlotType, nextProps.modelsToShow,\r\n    //         //                  nextProps.residueColorStyle);\r\n    //         this.updateChart(nextProps.chainsToShow, nextProps.ramaContourPlotType, nextProps.modelsToShow,\r\n    //             nextProps.residueColorStyle);\r\n    //         this.basicContours(nextProps.ramaContourPlotType, nextProps.contourColoringStyle);\r\n    //     } else if (nextProps.residueColorStyle !== this.state.residueColorStyle) {\r\n    //         this.updateChart(nextProps.chainsToShow, nextProps.ramaContourPlotType, nextProps.modelsToShow,\r\n    //             nextProps.residueColorStyle);\r\n    //     } else if (nextProps.contourColoringStyle !== this.state.contourColoringStyle) {\r\n    //         // console.log(nextProps.contourColoringStyle, this.state.contourColoringStyle);\r\n    //         this.basicContours(nextProps.ramaContourPlotType, nextProps.contourColoringStyle);\r\n    //     }\r\n    //\r\n    // }\r\n    // public shouldComponentUpdate(nextProps: any, nextState: any) {\r\n    //     if (nextState.pdb.length === 4 && nextProps.pdbID !== this.state.pdb)  {\r\n    //         return true;\r\n    //     }\r\n    //     if (nextProps.ramaContourPlotType !== this.state.ramaContourPlotType) {\r\n    //         return true;\r\n    //     }\r\n    //     if (nextProps.contourColoringStyle !== this.state.contourColoringStyle) {\r\n    //         return true;\r\n    //     }\r\n    //     if (nextProps.modelsToShow.length !== this.state.modelsToShow.length) {\r\n    //         return true;\r\n    //     }\r\n    //     if (nextProps.residueColorStyle !== this.state.residueColorStyle) {\r\n    //         return true;\r\n    //     }\r\n    //     return nextProps.chainsToShow.length !== this.state.chainsToShow.length;\r\n    // }\r\n    createChart() {\r\n        let width = 500, height = 500;\r\n        // let element = document.getElementById('rama-root');\r\n        // const node = document.createElement('div');\r\n        // node.setAttribute('id', 'ramachandran-root-element');\r\n        // element.appendChild(node);\r\n        if (width > 768) {\r\n            width = 580;\r\n        }\r\n        if (height > 768) {\r\n            height = 580;\r\n        }\r\n        // setup x\r\n        const xScale = d3.scaleLinear()\r\n            .domain([-180, 180])\r\n            .range([0, (width)]);\r\n        this.xBottomAxis = d3.axisBottom(xScale);\r\n        this.xTopAxis = d3.axisTop(xScale);\r\n        this.xTopAxis = d3.axisTop(xScale);\r\n        const xValue = (d) => d['phi'];\r\n        this.xMap = (d) => xScale(xValue(d));\r\n        // tooltip\r\n        this.tooltip = d3.select('body').append('div')\r\n            .attr('class', 'rama-tooltip')\r\n            .attr('height', 0)\r\n            .style('opacity', 0);\r\n        // setup y\r\n        const yScale = d3.scaleLinear()\r\n            .domain([180, -180])\r\n            .range([0, (height)]);\r\n        this.yLeftAxis = d3.axisLeft(yScale);\r\n        this.yRightAxis = d3.axisRight(yScale);\r\n        const yValue = (d) => d['psi'];\r\n        this.yMap = (d) => yScale(yValue(d));\r\n        function makeYGridlines() {\r\n            return d3.axisRight(yScale);\r\n        }\r\n        function makeXGridlines() {\r\n            return d3.axisTop(xScale);\r\n        }\r\n        this.svgContainer = d3.select('rama-scatter').append('div')\r\n            .attr('id', 'rama-svg-container')\r\n            .attr('height', height)\r\n            .attr('border', '1px solid black')\r\n            .append('svg')\r\n            .attr('max-width', width)\r\n            .classed('svg-container', true)\r\n            .attr('id', 'rama-svg')\r\n            .attr('preserveAspectRatio', 'xMinYMin meet')\r\n            .attr('viewBox', '0 0 ' + width + ' ' + height)\r\n            .classed('svg-content-responsive', true)\r\n            .style('overflow', 'visible');\r\n        this.canvasContainer = d3.select('#rama-svg-container')\r\n            .append('canvas')\r\n            .classed('img-responsive', true)\r\n            .attr('id', 'rama-canvas')\r\n            .attr('width', width)\r\n            .attr('height', height)\r\n            .classed('svg-content-responsive', true)\r\n            .attr('preserveAspectRatio', 'xMinYMin meet')\r\n            .attr('viewBox', '0 0 ' + width + ' ' + height)\r\n            .style('padding', '30px 30px 30px 50px')\r\n            .style('overflow', 'visible');\r\n        // console.log(this.canvasContainer);\r\n        // // add axes\r\n        this.svgContainer.append('g')\r\n            .call(this.xTopAxis)\r\n            .attr('id', 'x-axis');\r\n        this.svgContainer.append('g')\r\n            .attr('transform', 'translate(0,' + (height) + ')')\r\n            .call(this.xBottomAxis)\r\n            .attr('id', 'x-axis');\r\n        this.svgContainer.append('g')\r\n            .call(this.yLeftAxis)\r\n            .attr('id', 'y-axis');\r\n        this.svgContainer.append('g')\r\n            .attr('transform', () => 'translate(' + (width) + ', 0)')\r\n            .call(this.yRightAxis)\r\n            .attr('id', 'y-axis');\r\n        this.svgContainer.append('g')\r\n            .attr('class', 'rama-grid')\r\n            .attr('transform', 'translate(0,' + height + ')')\r\n            .call(makeXGridlines()\r\n            .tickSize(width));\r\n        this.svgContainer.append('g')\r\n            .attr('class', 'rama-grid')\r\n            .call(makeYGridlines()\r\n            .tickSize(height));\r\n        // axis labels\r\n        // phi label\r\n        this.svgContainer.append('text')\r\n            .attr('x', width / 2)\r\n            .attr('y', height + 35)\r\n            .style('text-anchor', 'middle')\r\n            .style('fill', '#000')\r\n            .text('\\u03A6');\r\n        // psi label\r\n        this.svgContainer.append('text')\r\n            .attr('x', 0 - (height / 2))\r\n            .attr('y', -35)\r\n            .style('text-anchor', 'middle')\r\n            .style('fill', '#000')\r\n            .attr('transform', 'rotate(-90)')\r\n            .text('\\u03A8');\r\n        //\r\n        // // outliers headline\r\n        // d3.select('#rama-root').append('div')\r\n        //     .attr('class', 'rama-outliers-div')\r\n        //     .append('div')\r\n        //     .attr('class', 'rama-outliers-headline')\r\n        //     .append('h4')\r\n        //     .text('OUTLIERS');\r\n        //\r\n        // d3.select('.rama-outliers-div').append('div')\r\n        //     .attr('class', 'outliers-container');\r\n        d3.selectAll('g.rama-grid g.tick text').remove();\r\n        d3.select('#rama-svg-container').append('div').attr('id', 'rama-sum').attr('class', 'rama-set-cl');\r\n        d3.select('#rama-svg-container').append('div').attr('id', 'rama-settings').attr('class', 'rama-set-cl');\r\n        let colorSelect = d3.select('#rama-settings').append('select').attr('id', 'rama-coloring');\r\n        colorSelect.append('option').attr('value', 1).text('Default');\r\n        colorSelect.append('option').attr('value', 2).text('Quality');\r\n        colorSelect.append('option').attr('value', 3).text('RSRZ');\r\n        colorSelect.on('change', this.filteringChange);\r\n        let plotTypeSelect = d3.select('#rama-settings').append('select').attr('id', 'rama-plot-type');\r\n        plotTypeSelect.append('option').attr('value', 1).text('General case');\r\n        plotTypeSelect.append('option').attr('value', 2).text('Isoleucine and valine');\r\n        plotTypeSelect.append('option').attr('value', 3).text('Pre-proline');\r\n        plotTypeSelect.append('option').attr('value', 4).text('Glycine');\r\n        plotTypeSelect.append('option').attr('value', 5).text('Trans proline');\r\n        plotTypeSelect.append('option').attr('value', 6).text('Cis proline');\r\n        plotTypeSelect.on('change', this.plotTypeChanged);\r\n        let ramaForm = d3.select('#rama-settings').append('form').attr('id', 'rama-contour-style');\r\n        ramaForm.append('label').classed('rama-contour-style', true).text('Contour').append('input')\r\n            .attr('type', 'radio')\r\n            .attr('name', 'contour-style')\r\n            .attr('value', 1)\r\n            .attr('checked', true)\r\n            .classed('rama-contour-radio', true);\r\n        ramaForm.append('label').classed('rama-contour-style', true).text('Heat Map').append('input')\r\n            .attr('type', 'radio')\r\n            .attr('name', 'contour-style')\r\n            .attr('value', 2)\r\n            .classed('rama-contour-radio', true);\r\n        ramaForm.on('change', this.coloringChanged);\r\n        this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShow, this.residueColorStyle);\r\n        this.basicContours(this.ramaContourPlotType, this.contourColoringStyle);\r\n    }\r\n    plotTypeChanged() {\r\n        this.ramaContourPlotType = d3.select('#rama-plot-type').property('value');\r\n        this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShow, this.residueColorStyle);\r\n        this.basicContours(this.ramaContourPlotType, this.contourColoringStyle);\r\n    }\r\n    coloringChanged() {\r\n        this.contourColoringStyle = d3.select('input[name=\"contour-style\"]:checked').property('value');\r\n        this.basicContours(this.ramaContourPlotType, this.contourColoringStyle);\r\n    }\r\n    filteringChange() {\r\n        this.residueColorStyle = d3.select('#rama-coloring').property('value');\r\n        this.updateChart(this.chainsToShow, this.ramaContourPlotType, this.modelsToShow, this.residueColorStyle);\r\n        this.basicContours(this.ramaContourPlotType, this.contourColoringStyle);\r\n    }\r\n    fillColorFunction(d, drawingType, outliersType, rsrz, compute = false) {\r\n        switch (drawingType) {\r\n            case 1:\r\n                if (d.rama === 'OUTLIER') {\r\n                    return '#f00';\r\n                }\r\n                return 'black';\r\n            case 2:\r\n                if (typeof outliersType[d.num] === 'undefined') {\r\n                    return '#008000';\r\n                }\r\n                else {\r\n                    if (compute === true) {\r\n                        if (outliersType[d.num].outliersType.includes('clashes')) {\r\n                            this.clashes++;\r\n                        }\r\n                        if (outliersType[d.num].outliersType.includes('ramachandran_outliers')) {\r\n                            this.ramachandranOutliers++;\r\n                        }\r\n                        if (outliersType[d.num].outliersType.includes('sidechain_outliers')) {\r\n                            this.sidechainOutliers++;\r\n                        }\r\n                    }\r\n                    switch (outliersType[d.num].outliersType.length) {\r\n                        case 0:\r\n                            return '#008000';\r\n                        case 1:\r\n                            return '#ff0';\r\n                        case 2:\r\n                            return '#f80';\r\n                        default:\r\n                            return '#850013';\r\n                    }\r\n                }\r\n            case 3:\r\n                if (typeof rsrz[d.num] === 'undefined') {\r\n                    return 'black';\r\n                }\r\n                else {\r\n                    if (compute === true) {\r\n                        this.rsrzCount++;\r\n                    }\r\n                    return '#f00';\r\n                }\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    updateChart(chainsToShow, ramaContourPlotType, entityToShow, drawingType) {\r\n        this.svgContainer.selectAll('g.dataGroup').remove();\r\n        let width = 500;\r\n        const tooltip = this.tooltip;\r\n        const { jsonObject, fillColorFunction, outliersType, rsrz, highlightedResidues } = this;\r\n        if (width > 768) {\r\n            width = 580;\r\n        }\r\n        // if (height > 768) {\r\n        //     height = 580;\r\n        // }\r\n        let objSize = 40;\r\n        if (window.screen.availWidth < 1920) {\r\n            objSize = 30;\r\n        }\r\n        if (window.screen.width < 350) {\r\n            objSize = 5;\r\n        }\r\n        const pdbId = this.pdbId;\r\n        const outliersList = [];\r\n        // scales\r\n        const xScale = d3.scaleLinear()\r\n            .domain([-180, 180])\r\n            .range([0, (width)]);\r\n        // .range([0, (0.985 * width)]);\r\n        const yScale = d3.scaleLinear()\r\n            .domain([180, -180])\r\n            .range([0, (width)]);\r\n        // symbolTypes\r\n        const symbolTypes = {\r\n            circle: d3.symbol().type(d3.symbolCircle).size(objSize),\r\n            triangle: d3.symbol().type(d3.symbolTriangle).size(objSize)\r\n        };\r\n        function switchPlotType(d, i) {\r\n            switch (ramaContourPlotType) {\r\n                case 1:\r\n                    return d;\r\n                case 2:\r\n                    if (d.aa === 'ILE' || d.aa === 'VAL') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                case 3:\r\n                    if (i + 1 !== jsonObject.length && jsonObject[i + 1].aa === 'PRO') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                case 4:\r\n                    if (d.aa === 'GLY') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                case 5:\r\n                    if (d.cisPeptide === null && d.aa === 'PRO') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                case 6:\r\n                    if (d.cisPeptide === 'Y' && d.aa === 'PRO') {\r\n                        return d;\r\n                    }\r\n                    break;\r\n                default:\r\n                    return d;\r\n            }\r\n        }\r\n        function tooltipText(d) {\r\n            // language=HTML\r\n            return `<b>${d.chain} ${d.num} ${d.aa}</b><br/>\\u03A6: ${d.phi}<br/>\\u03A8: ${d.psi}`;\r\n        }\r\n        function compare(a, b) {\r\n            switch (drawingType) {\r\n                case 1:\r\n                    if (a.rama === 'OUTLIER') {\r\n                        return a;\r\n                    }\r\n                    if (a.rama === 'Allowed') {\r\n                        return a;\r\n                    }\r\n                    if (a.rama === 'Favored') {\r\n                        return a;\r\n                    }\r\n                    break;\r\n                case 2:\r\n                    if (typeof outliersType[a.num] === 'undefined') {\r\n                        return b;\r\n                    }\r\n                    else if (typeof outliersType[b.num] === 'undefined') {\r\n                        return a;\r\n                    }\r\n                    else if (outliersType[a.num].outliersType.length > outliersType[b.num].outliersType.length) {\r\n                        return a;\r\n                    }\r\n                    else {\r\n                        return b;\r\n                    }\r\n                case 3:\r\n                    if (typeof rsrz[a.num] === 'undefined') {\r\n                        return b;\r\n                    }\r\n                    else {\r\n                        return a;\r\n                    }\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n        // sort because of svg z-index\r\n        jsonObject.sort((a, b) => {\r\n            switch (drawingType) {\r\n                case 1:\r\n                    if (a.rama === 'OUTLIER') {\r\n                        if (b.rama === 'Allowed') {\r\n                            return 1;\r\n                        }\r\n                        if (b.rama === 'Favored') {\r\n                            return 1;\r\n                        }\r\n                        if (b.rama === 'OUTLIER') {\r\n                            return 0;\r\n                        }\r\n                    }\r\n                    if (a.rama === 'Allowed') {\r\n                        if (b.rama === 'Allowed') {\r\n                            return 0;\r\n                        }\r\n                        if (b.rama === 'Favored') {\r\n                            return 1;\r\n                        }\r\n                        if (b.rama === 'OUTLIER') {\r\n                            return -1;\r\n                        }\r\n                    }\r\n                    if (a.rama === 'Favored') {\r\n                        if (b.rama === 'Allowed') {\r\n                            return -1;\r\n                        }\r\n                        if (b.rama === 'Favored') {\r\n                            return 0;\r\n                        }\r\n                        if (b.rama === 'OUTLIER') {\r\n                            return -1;\r\n                        }\r\n                    }\r\n                    break;\r\n                case 2:\r\n                    if (typeof outliersType[a.num] === 'undefined') {\r\n                        return -1;\r\n                    }\r\n                    else if (typeof outliersType[b.num] === 'undefined') {\r\n                        return 1;\r\n                    }\r\n                    else if (outliersType[a.num].outliersType.length > outliersType[b.num].outliersType.length) {\r\n                        return 1;\r\n                    }\r\n                    else {\r\n                        return -1;\r\n                    }\r\n                case 3:\r\n                    if (typeof rsrz[a.num] === 'undefined') {\r\n                        return -1;\r\n                    }\r\n                    else if (typeof rsrz[b.num] === 'undefined') {\r\n                        return 1;\r\n                    }\r\n                    else {\r\n                        return 1;\r\n                    }\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n        // outliersText\r\n        d3.selectAll('.outliers').remove();\r\n        d3.selectAll('table').remove();\r\n        let favored = 0;\r\n        let allowed = 0;\r\n        d3.select('.outliers-container').append('table')\r\n            .attr('class', 'rama-outliers-table').append('thead').append('tr').attr('id', 'tab-headline');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('Chain')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('ID')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('AA')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('Phi')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        d3.select('#tab-headline').append('th').attr('class', 'rama-table-headline').text('Psi')\r\n            .style('width', '30%').style('min-width', '50px').style('text-align', 'right');\r\n        //\r\n        this.outliersTable = d3.select('.outliers-container').append('div')\r\n            .attr('class', 'outliers').append('table')\r\n            .attr('class', 'table table-hover table-responsive');\r\n        function dispatchCustomEvent(name, d) {\r\n            const event = new CustomEvent(name, { detail: {\r\n                    chainId: d.chain,\r\n                    entityId: d.modelId,\r\n                    entry: pdbId,\r\n                    residueName: d.aa,\r\n                    residueNumber: d.num\r\n                } });\r\n            window.dispatchEvent(event);\r\n        }\r\n        console.log(entityToShow);\r\n        this.svgContainer.selectAll('.shapes')\r\n            .data(jsonObject.filter((d, i) => {\r\n            if (chainsToShow.indexOf(d.chain) !== -1 && entityToShow.indexOf(d.modelId) !== -1) {\r\n                if (d.phi !== null || d.psi !== null) {\r\n                    return switchPlotType(d, i);\r\n                }\r\n            }\r\n        }))\r\n            .enter()\r\n            .append('g')\r\n            .attr('class', 'dataGroup')\r\n            .append('path')\r\n            .attr('id', (d) => {\r\n            const id = d.aa + '-' + d.chain + '-' + d.modelId + '-' + d.num;\r\n            console.log(id);\r\n            d.idSlector = id;\r\n            if (drawingType !== 3) {\r\n                if (d.rama === 'OUTLIER') {\r\n                    outliersList.push(d);\r\n                }\r\n                if (d.rama === 'Favored') {\r\n                    favored++;\r\n                }\r\n                if (d.rama === 'Allowed') {\r\n                    allowed++;\r\n                }\r\n                return id;\r\n            }\r\n            if (d.rama === 'OUTLIER' && typeof rsrz[d.num] !== 'undefined') {\r\n                outliersList.push(d);\r\n                return id;\r\n            }\r\n            return id;\r\n        })\r\n            .attr('d', (d) => {\r\n            if (d.aa === 'GLY') {\r\n                return symbolTypes.triangle();\r\n            }\r\n            return symbolTypes.circle();\r\n        })\r\n            .attr('transform', (d) => 'translate(' + xScale(d.phi) + ',' + yScale(d.psi) + ')')\r\n            .merge(this.svgContainer)\r\n            // .style('fill', 'transparent')\r\n            .style('fill', (d) => fillColorFunction(d, drawingType, outliersType, rsrz, true))\r\n            .style('opacity', (d) => {\r\n            const fillTmp = fillColorFunction(d, drawingType, outliersType, rsrz);\r\n            // console.log(fillTmp);\r\n            if (fillTmp === '#008000' || fillTmp === 'black') {\r\n                return 0.15;\r\n            }\r\n            if (fillTmp === '#ff0') {\r\n                return 0.8;\r\n            }\r\n            return 1;\r\n        })\r\n            .on('mouseover', function (d) {\r\n            let height = 58;\r\n            let width = 90;\r\n            dispatchCustomEvent('PDB.ramaViewer.mouseOver', d);\r\n            switch (drawingType) {\r\n                case 1:\r\n                    if (d.rama === 'Favored') {\r\n                        tooltip.html(tooltipText(d) + '<br/> Favored');\r\n                    }\r\n                    if (d.rama === 'Allowed') {\r\n                        tooltip.html(tooltipText(d) + '<br/> Allowed');\r\n                    }\r\n                    if (d.rama === 'OUTLIER') {\r\n                        tooltip.html(tooltipText(d) + '<br/><b>OUTLIER</b>');\r\n                    }\r\n                    break;\r\n                case 2:\r\n                    let tempStr = '';\r\n                    if (typeof outliersType[d.num] === 'undefined') {\r\n                        tooltip.html(tooltipText(d));\r\n                        break;\r\n                    }\r\n                    if (outliersType[d.num].outliersType.includes('clashes')) {\r\n                        tempStr += '<br/>Clash';\r\n                    }\r\n                    if (outliersType[d.num].outliersType.includes('ramachandran_outliers')) {\r\n                        tempStr += '<br/>Ramachandran outlier';\r\n                        width += 40;\r\n                    }\r\n                    if (outliersType[d.num].outliersType.includes('sidechain_outliers')) {\r\n                        tempStr += '<br/>Sidechain outlier';\r\n                        width += 10;\r\n                    }\r\n                    if (outliersType[d.num].outliersType.includes('bond_angles')) {\r\n                        tempStr += '<br/>Bond angles';\r\n                    }\r\n                    else {\r\n                        tooltip.html(tooltipText(d));\r\n                    }\r\n                    switch (outliersType[d.num].outliersType.length) {\r\n                        case 2:\r\n                            height += 10;\r\n                            break;\r\n                        case 3:\r\n                            height += 20;\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n                    tooltip.html(tooltipText(d) + tempStr);\r\n                    break;\r\n                case 3:\r\n                    if (typeof rsrz[d.num] === 'undefined') {\r\n                        tooltip.html(tooltipText(d));\r\n                    }\r\n                    else {\r\n                        tooltip.html(tooltipText(d) + '<br/><b>RSRZ outlier</b>');\r\n                    }\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            tooltip.transition()\r\n                .style('opacity', .95)\r\n                .style('left', (d3.event.pageX + 10) + 'px')\r\n                .style('top', (d3.event.pageY - 48) + 'px')\r\n                .style('height', height)\r\n                .style('width', String(width) + 'px');\r\n            d3.select(this)\r\n                .attr('d', (d) => changeObjectSize(d, false))\r\n                .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n        })\r\n            .on('mouseout', function (d) {\r\n            dispatchCustomEvent('PDB.ramaViewer.mouseOut', d);\r\n            if (highlightedResidues.indexOf(d) > -1) {\r\n                return;\r\n            }\r\n            d3.select(this)\r\n                .transition()\r\n                // .duration(50)\r\n                .attr('d', (dat) => changeObjectSize(dat))\r\n                // .style('fill', 'transparent')\r\n                .style('fill', (d) => fillColorFunction(d, drawingType, outliersType, rsrz));\r\n            // .style('fillColorFunction-width', '0.5');\r\n            tooltip.transition()\r\n                // .duration(50)\r\n                .style('opacity', 0);\r\n        })\r\n            .on('click', function (d) {\r\n            if (highlightedResidues.indexOf(d) > -1) {\r\n                unHighlightObject(true);\r\n                return;\r\n            }\r\n            unHighlightObject(true);\r\n            dispatchCustomEvent('PDB.ramaViewer.click', d);\r\n            highlightedResidues.push(d);\r\n            d3.select(this)\r\n                .attr('d', (d) => changeObjectSize(d, false))\r\n                .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n        });\r\n        outliersList.sort((a, b) => a.num - b.num);\r\n        // this.setState({\r\n        //     initial: false\r\n        // });\r\n        this.firstRun = false;\r\n        switch (drawingType) {\r\n            case 1:\r\n                d3.selectAll('#rama-sum-div').remove();\r\n                d3.select('#rama-sum').append('div').attr('id', 'rama-sum-div')\r\n                    .append('div').attr('class', 'rama-sum-cell').attr('id', 'rama-sum-widest')\r\n                    .text('Preferred regions: ' + String(favored)\r\n                    + ' (' + String((favored / jsonObject.length * 100).toFixed(0))\r\n                    + '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-middle')\r\n                    .text('Allowed regions: ' + String(allowed)\r\n                    + ' (' + String((allowed / jsonObject.length * 100).toFixed(0))\r\n                    + '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-thinnest')\r\n                    .text('Outliers: ' + String(outliersList.length)\r\n                    + ' (' + String((outliersList.length / jsonObject.length * 100).toFixed(0)) + '%)').enter();\r\n                break;\r\n            case 2:\r\n                d3.selectAll('#rama-sum-div').remove();\r\n                d3.select('#rama-sum').append('div').attr('id', 'rama-sum-div')\r\n                    .append('div').attr('class', 'rama-sum-cell').attr('id', 'rama-sum-widest')\r\n                    .text('Ramachandran outliers: ' + String(this.ramachandranOutliers)\r\n                    + ' (' + String((this.ramachandranOutliers / jsonObject.length * 100).toFixed(0)) +\r\n                    '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-middle')\r\n                    .text('Sidechain outliers: ' + String(this.sidechainOutliers)\r\n                    + ' (' + String((this.sidechainOutliers / jsonObject.length * 100).toFixed(0)) + '%)').enter();\r\n                d3.select('#rama-sum-div').append('div').attr('class', 'rama-sum-cell')\r\n                    .attr('id', 'rama-sum-thinnest')\r\n                    .text('Clashes: ' + String(this.clashes)\r\n                    + ' (' + String((this.clashes / jsonObject.length * 100).toFixed(0)) + '%)').enter();\r\n                break;\r\n            case 3:\r\n                d3.selectAll('#rama-sum-div').remove();\r\n                d3.select('#rama-sum').append('div').attr('id', 'rama-sum-div')\r\n                    .append('div').attr('class', 'rama-sum-cell').attr('id', 'rama-sum-widest')\r\n                    .text('RSRZ: ' + String(this.rsrzCount)\r\n                    + ' (' + String((this.rsrzCount / jsonObject.length * 100).toFixed(0)) + '%) ').enter();\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n        // const butt = d3.select('div#ramachandran-root-element').append('button').text('OK');\r\n        // butt.on('mouseover', () => {\r\n        //     unHighlightObject(false);\r\n        //     d3.select('path#ASN-A-1-14').attr('d', (dat: any) => {\r\n        //         if (dat.aa === 'GLY') {\r\n        //             symbolTypes.triangle.size(175);\r\n        //             return symbolTypes.triangle();\r\n        //         }\r\n        //         symbolTypes.circle.size(175);\r\n        //         return symbolTypes.circle();\r\n        //     });\r\n        // }).on('mouseout', (d: any) => {\r\n        //     unHighlightObject(false);\r\n        // });\r\n        //\r\n        // const butt2 = d3.select('div#ramachandran-root-element').append('button').text('OK');\r\n        // butt2.on('mouseover', () => {\r\n        //     unHighlightObject(false);\r\n        //     d3.select('path#VAL-A-1-26').attr('d', (dat: any) => {\r\n        //         if (dat.aa === 'GLY') {\r\n        //             symbolTypes.triangle.size(175);\r\n        //             return symbolTypes.triangle();\r\n        //         }\r\n        //         symbolTypes.circle.size(175);\r\n        //         return symbolTypes.circle();\r\n        //     });\r\n        // }).on('mouseout', (d: any) => {\r\n        //     unHighlightObject(false);\r\n        // });\r\n        //\r\n        // const butt3 = d3.select('div#ramachandran-root-element').append('button').text('OK');\r\n        // butt3.on('click', () => {\r\n        //     const res = d3.select('path#TRP-A-1-87');\r\n        //     if (highlightedResidues.indexOf(res) > -1) {\r\n        //         unHighlightObject(true);\r\n        //         return;\r\n        //     }\r\n        //     unHighlightObject(true);\r\n        //     highlightedResidues.push(res);\r\n        //     highLightObject(event);\r\n        // }).on('mouseover', () => {\r\n        //     unHighlightObject(false);\r\n        //     d3.select('path#TRP-A-1-87').attr('d', (dat: any) => {\r\n        //         if (dat.aa === 'GLY') {\r\n        //             symbolTypes.triangle.size(175);\r\n        //             return symbolTypes.triangle();\r\n        //         }\r\n        //         symbolTypes.circle.size(175);\r\n        //         return symbolTypes.circle();\r\n        //     });\r\n        // }).on('mouseout', (d: any) => {\r\n        //     unHighlightObject(false);\r\n        // });\r\n        function changeObjectSize(d, smaller = true) {\r\n            let size = 175;\r\n            if (smaller) {\r\n                size = objSize;\r\n            }\r\n            if (d.aa === 'GLY') {\r\n                symbolTypes.triangle.size(size);\r\n                return symbolTypes.triangle();\r\n            }\r\n            symbolTypes.circle.size(size);\r\n            return symbolTypes.circle();\r\n        }\r\n        function unHighlightObject(all = true) {\r\n            if (all) {\r\n                highlightedResidues.forEach((d) => {\r\n                    d3.select('#' + d._idSlector)\r\n                        .attr('d', (d) => changeObjectSize(d)).transition().duration(50);\r\n                });\r\n                highlightedResidues.pop();\r\n                return;\r\n            }\r\n            d3.selectAll('path').filter((d) => {\r\n                if (d) {\r\n                    if (highlightedResidues.indexOf(d) === -1) {\r\n                        return d;\r\n                    }\r\n                }\r\n            }).each((d) => d).attr('d', (d) => changeObjectSize(d)).transition().duration(50);\r\n            // if (!all) {\r\n            //     d3.selectAll('path').filter((d: any) => {\r\n            //         if (d) {\r\n            //             if (d.spProp === true) {\r\n            //                 d.spProp = false;\r\n            //                 return d;\r\n            //             }\r\n            //         }\r\n            //     }).each((d) => d).attr('d', (d: any) => changeObjectSize(d)).transition().duration(50);\r\n            // }\r\n            // highlightedResidues.forEach((d: any) => {\r\n            //     if (all && d.spProp) {\r\n            //         d.spProp = false;\r\n            //         return;\r\n            //     }\r\n            //     d3.select('#' + d._idSlector).attr('d', (d: any) => changeObjectSize(d)).transition().duration(50);\r\n            // });\r\n            // d3.selectAll('path').filter((d: any) => {\r\n            //     if (d) {\r\n            //         if (all) {\r\n            //             if (d.spProp) {\r\n            //                 d.spProp = false;\r\n            //             }\r\n            //             return d;\r\n            //         }\r\n            //         if (d.spProp === false) {\r\n            //             return d;\r\n            //         }\r\n            //     }\r\n            // }).each((d) => d).attr('d', (dat: any) => {\r\n            //     if (dat) {\r\n            //         // console.log(dat.aa);\r\n            //         if (dat.aa === 'GLY') {\r\n            //             symbolTypes.triangle.size(objSize);\r\n            //             return symbolTypes.triangle();\r\n            //         }\r\n            //         symbolTypes.circle.size(objSize);\r\n            //         return symbolTypes.circle();\r\n            //     }\r\n            // }).transition().duration(50);\r\n        }\r\n        function getRes(event) {\r\n            return d3.select('path#' + event.eventData.residuesName + '-' +\r\n                event.eventData.chainId + '-' +\r\n                event.eventData.entityId + '-' +\r\n                event.eventData.residueNumber);\r\n        }\r\n        function highLightObject(event) {\r\n            // highlightedResidues.push(res);\r\n            getRes(event).attr('d', (d) => changeObjectSize(d, false))\r\n                .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n        }\r\n        window.addEventListener('PDB.litemol.mouseover', (event) => {\r\n            unHighlightObject(false);\r\n            highLightObject(event);\r\n        });\r\n        window.addEventListener('PDB.litemol.click', (event) => {\r\n            const res = getRes(event);\r\n            if (highlightedResidues.indexOf(res) > -1) {\r\n                unHighlightObject(true);\r\n                return;\r\n            }\r\n            unHighlightObject(true);\r\n            highlightedResidues.push(res);\r\n            highLightObject(event);\r\n        });\r\n        window.addEventListener('PDB.litemol.mouseout', (event) => {\r\n            if (highlightedResidues.indexOf(event) > -1) {\r\n                return;\r\n            }\r\n            unHighlightObject(false);\r\n        });\r\n        window.addEventListener('PDB.topologyViewer.click', (event) => {\r\n            const res = getRes(event);\r\n            if (highlightedResidues.indexOf(res) > -1) {\r\n                unHighlightObject(true);\r\n                return;\r\n            }\r\n            unHighlightObject(true);\r\n            highlightedResidues.push(res);\r\n            highLightObject(event);\r\n        });\r\n        window.addEventListener('PDB.topologyViewer.mouseover', (event) => {\r\n            unHighlightObject(false);\r\n            highLightObject(event);\r\n        });\r\n        window.addEventListener('PDB.topologyViewer.mouseout', () => {\r\n            if (highlightedResidues.indexOf(event) > -1) {\r\n                return;\r\n            }\r\n            unHighlightObject(false);\r\n        });\r\n        this.sidechainOutliers = 0;\r\n        this.rsrzCount = 0;\r\n        this.clashes = 0;\r\n        this.ramachandranOutliers = 0;\r\n        // this.addTable(outliersList, drawingType);\r\n    }\r\n    basicContours(ramaContourPlotType, contourType) {\r\n        d3.select('#rama-canvas').empty();\r\n        d3.selectAll('.contour-line').remove();\r\n        const canvas = this.canvasContainer;\r\n        // let svg = this.svgContainer;\r\n        let width = 500, height = 500;\r\n        // console.log(ramaContourPlotType);\r\n        if (width > 768) {\r\n            width = 580;\r\n        }\r\n        if (height > 768) {\r\n            height = 580;\r\n        }\r\n        //\r\n        // let node: any = (d3.select('svg.svg-container').node());\r\n        // let width = (node.getBoundingClientRect().width) - this.leftPadding - this.padding;\r\n        // let height = (node.getBoundingClientRect().height) - this.leftPadding - this.padding;\r\n        // console.log(width, height);\r\n        // const xScale = d3.scaleLinear()\r\n        //     .domain([-180, 180])\r\n        //     .range([0, (width)]);\r\n        //     // .range([0, (0.985 * width)]);\r\n        //\r\n        // const yScale = d3.scaleLinear()\r\n        //     .domain([180, -180])\r\n        //     .range([0, (height)]);\r\n        //     // .range([0, (0.985 * height)]);\r\n        // let url = 'https://raw.githubusercontent.com/ondraab/rama/master/public/data/';\r\n        const img = new Image();\r\n        const svgImg = new Image();\r\n        switch (ramaContourPlotType) {\r\n            case 1:\r\n                // url += 'rama8000-general-noGPIVpreP.csv';\r\n                img.src = HeatMapContours_1.generalContour;\r\n                svgImg.src = LineContours_1.lineGeneralContour;\r\n                break;\r\n            case 2:\r\n                // url += 'rama8000-ileval-nopreP.csv';\r\n                img.src = HeatMapContours_1.ileVal;\r\n                svgImg.src = LineContours_1.lineIleVal;\r\n                break;\r\n            case 3:\r\n                // url += 'rama8000-prepro-noGP.csv';\r\n                img.src = HeatMapContours_1.prePro;\r\n                svgImg.src = LineContours_1.linePrePro;\r\n                break;\r\n            case 4:\r\n                // url += 'rama8000-gly-sym.csv';\r\n                img.src = HeatMapContours_1.gly;\r\n                svgImg.src = LineContours_1.lineGly;\r\n                break;\r\n            case 5:\r\n                // url += 'rama8000-transpro.csv';\r\n                img.src = HeatMapContours_1.transPro;\r\n                svgImg.src = LineContours_1.lineTransPro;\r\n                break;\r\n            case 6:\r\n                // url += 'rama8000-cispro.csv';\r\n                img.src = HeatMapContours_1.cisPro;\r\n                svgImg.src = LineContours_1.lineCisPro;\r\n                break;\r\n            default:\r\n                return;\r\n        }\r\n        const context = canvas.node().getContext('2d');\r\n        context.clearRect(0, 0, width + 80, height + 60);\r\n        if (contourType === 2) {\r\n            context.globalAlpha = 0.6;\r\n            img.onload = () => {\r\n                context.drawImage(img, 0, 0, width, height * img.height / img.width);\r\n            };\r\n        }\r\n        else {\r\n            context.globalAlpha = 1;\r\n            svgImg.onload = () => {\r\n                context.drawImage(svgImg, 0, 0, width, height * svgImg.height / svgImg.width);\r\n            };\r\n            //\r\n            // setTimeout(function () {\r\n            //             // let s = new XMLSerializer().serializeToString(document.getElementById('rama-svg'));\r\n            //             // let encode = window.btoa(s);\r\n            //     let enc: any = document.getElementById('rama-canvas');\r\n            //     console.log(enc.toDataURL());\r\n            //         }, 3000);\r\n            // d3.csv(url, function (error: any, data: any) {\r\n            //     if (error) {\r\n            //         throw error;\r\n            //     }\r\n            //\r\n            //     data.sort(function (a: any, b: any) {\r\n            //         return b.value - a.value;\r\n            //     });\r\n            //     data.forEach(function (d: any) {\r\n            //         d.psi = +d.psi;\r\n            //         d.phi = +d.phi;\r\n            //         d.value = +d.value;\r\n            //     });\r\n            //     //\r\n            //     // scale(0.965, 0.965), translate(16, 16)\r\n            //     let scale = '';\r\n            //     switch (ramaContourPlotType) {\r\n            //         case '2':\r\n            //             data = data.slice(0, data.length / 2.7);\r\n            //             break;\r\n            //         case '3':\r\n            //             data = data.slice(0, data.length / 2.5);\r\n            //             break;\r\n            //         case '4':\r\n            //             data = data.slice(0, data.length / 1.5);\r\n            //             break;\r\n            //         case '5':\r\n            //             data = data.slice(0, data.length / 3.7);\r\n            //             break;\r\n            //         case '6':\r\n            //             data = data.slice(0, data.length / 2.2);\r\n            //             break;\r\n            //         default:\r\n            //\r\n            //             // console.log(data[0], data[data.length-1]);\r\n            //             data = data.slice(0, (data.length / 2.1) - 850);\r\n            //             // data.splice(0, data.length-1000);\r\n            //     }\r\n            //     let median = d3.median(data, function (d: any) {\r\n            //         return d.value;\r\n            //     });\r\n            //     let max = d3.max(data, function (d: any) {\r\n            //         return +d.value;\r\n            //     });\r\n            //     let min = d3.min(data, function (d: any) {\r\n            //         return +d.value;\r\n            //     });\r\n            //     //\r\n            //     // let line = d3.line();\r\n            //     console.log(data.length);\r\n            //     svg.selectAll('.shapes')\r\n            //         .data(d3Contour.contourDensity()\r\n            //             .x(function (d: any) {\r\n            //                 return xScale(d.phi);\r\n            //             })\r\n            //             .y(function (d: any) {\r\n            //                 return yScale(d.psi);\r\n            //             })\r\n            //             .size([height, width])\r\n            //             .thresholds(d3.range(median, max, 5))\r\n            //             .cellSize(1)\r\n            //             .bandwidth(6)\r\n            //             (data))\r\n            //         .enter()\r\n            //         .append('path')\r\n            //         .attr('fillColorFunction', '#1359eb')\r\n            //         .attr('fillColorFunction-width', '2')\r\n            //         .attr('fill', 'none')\r\n            //         .attr('class', 'contour-line')\r\n            //         .attr('margin', '30px')\r\n            //         .attr('d', d3.geoPath())\r\n            //         .attr('transform', scale)\r\n            //         .attr('clip-path', 'url(#clipRect)');\r\n            //     // svg.selectAll('.shapes')\r\n            //     //     .data(d3Contour.contourDensity()\r\n            //     //         .x(function (d: any) {\r\n            //     //             return xScale(d.phi);\r\n            //     //         })\r\n            //     //         .y(function (d: any) {\r\n            //     //             return yScale(d.psi);\r\n            //     //         })\r\n            //     //         .size([height, width])\r\n            //     //         .thresholds(d3.ticks(min, max, 1))\r\n            //     //         .thresholds(d3.range(min, max))\r\n            //     //         .cellSize(1)\r\n            //     //         .bandwidth(1)\r\n            //     //         (data))\r\n            //     //     //\r\n            //     //     .enter()\r\n            //     //     .append('path')\r\n            //     //     .attr('fillColorFunction', '#1359eb')\r\n            //     //     .attr('fillColorFunction-width', '2')\r\n            //     //     .attr('fill', 'none')\r\n            //     //     .attr('class', 'line')\r\n            //     //     .attr('id', 'contour-basis-line')\r\n            //     //     .attr('margin', '30px')\r\n            //     //     .attr('d', d3.geoPath())\r\n            //     //     .attr('transform', scale);\r\n            //     let pa: any = document.getElementById('contour-basis-line');\r\n            //     // scale(0.99, 0.99),\r\n            //     switch (ramaContourPlotType) {\r\n            //         //\r\n            //         case '3':\r\n            //             data = data.slice(0, data.length / 2.9);\r\n            //             break;\r\n            //         case '2':\r\n            //             data = data.slice(0, data.length / 3);\r\n            //             break;\r\n            //         case '4':\r\n            //             data = data.slice(0, data.length / 1.65);\r\n            //             break;\r\n            //         case '5':\r\n            //             data = data.slice(0, data.length / 1.8);\r\n            //             break;\r\n            //         case '6':\r\n            //             data = data.slice(0, data.length / 2.2);\r\n            //             break;\r\n            //         default:\r\n            //             data = data.slice(0, data.length / 2.7);\r\n            //             break;\r\n            //     }\r\n            //     console.log(data.length);\r\n            //     svg.selectAll('.shapes')\r\n            //         .data(d3Contour.contourDensity()\r\n            //             .x(function (d: any) {\r\n            //                 return xScale(d.phi);\r\n            //             })\r\n            //             .y(function (d: any) {\r\n            //                 return yScale(d.psi);\r\n            //             })\r\n            //             .size([height, width])\r\n            //             .thresholds(d3.range(median, max, 5))\r\n            //             .cellSize(1)\r\n            //             .bandwidth(6)\r\n            //             (data))\r\n            //         .enter()\r\n            //         .append('path')\r\n            //         .attr('fillColorFunction', '#3ee2eb')\r\n            //         .attr('fillColorFunction-width', '2')\r\n            //         .attr('fill', 'none')\r\n            //         .attr('class', 'contour-line')\r\n            //         .attr('margin', '30px')\r\n            //         .attr('d', d3.geoPath())\r\n            //         .attr('transform', scale);\r\n            //    // scale(0.99,0.99),\r\n            // });\r\n            // if (ramaContourPlotType !== '1') {\r\n            //     setTimeout(function () {\r\n            //         let s = new XMLSerializer().serializeToString(document.getElementById('rama-svg'));\r\n            //         let encode = window.btoa(s);\r\n            //         console.log('data:image/svg+xml;base64,' + encode);\r\n            //     },         3000);\r\n            // }\r\n            //\r\n        }\r\n    }\r\n    addTable(sortedTable, drawingType) {\r\n        let objSize = 40;\r\n        const { fillColorFunction, outliersType, rsrz } = this;\r\n        if (window.screen.availWidth < 1920) {\r\n            objSize = 30;\r\n        }\r\n        if (window.screen.width < 350) {\r\n            objSize = 5;\r\n        }\r\n        const symbolTypes = {\r\n            circle: d3.symbol().type(d3.symbolCircle).size(30),\r\n            triangle: d3.symbol().type(d3.symbolTriangle).size(30)\r\n        };\r\n        const rows = this.outliersTable.selectAll('tbody tr')\r\n            .data(sortedTable, (d) => d.num);\r\n        rows.enter()\r\n            .append('tr')\r\n            .on('mouseover', function (d) {\r\n            d3.select(this)\r\n                .style('background-color', '#b4bed6')\r\n                .style('cursor', 'pointer');\r\n            d3.select('#' + d.aa + '-' + d.chain + '-' + d.modelId + '-' + d.num)\r\n                .attr('d', (dat) => {\r\n                if (dat.aa === 'GLY') {\r\n                    symbolTypes.triangle.size(175);\r\n                    return symbolTypes.triangle();\r\n                }\r\n                symbolTypes.circle.size(175);\r\n                return symbolTypes.circle();\r\n            })\r\n                .style('fill', (dat) => fillColorFunction(dat, drawingType, outliersType, rsrz));\r\n        })\r\n            //\r\n            .on('mouseout', function (d) {\r\n            d3.select(this)\r\n                .style('background-color', 'transparent')\r\n                .style('cursor', 'default');\r\n            d3.select('#' + d.aa + '-' + d.chain + '-' + d.modelId + '-' + d.num)\r\n                .transition()\r\n                // .duration(50)\r\n                .attr('d', (dat) => {\r\n                if (dat.aa === 'GLY') {\r\n                    symbolTypes.triangle.size(objSize);\r\n                    return symbolTypes.triangle();\r\n                }\r\n                symbolTypes.circle.size(objSize);\r\n                return symbolTypes.circle();\r\n            })\r\n                .style('fill', (d) => fillColorFunction(d, drawingType, outliersType, rsrz))\r\n                .style('fillColorFunction-width', '0.5');\r\n        })\r\n            .selectAll('td')\r\n            .data((d) => [d.chain, d.num, d.aa, d.phi, d.psi])\r\n            .enter()\r\n            .append('td')\r\n            .attr('id', 'rama-td')\r\n            .style('width', '30%')\r\n            .style('min-width', '50px')\r\n            .style('text-align', 'right')\r\n            .text((d) => d);\r\n        rows.exit().remove();\r\n        //\r\n        const cells = rows.selectAll('td')\r\n            .data((d) => [d.chain, d.num, d.aa, d.phi, d.psi])\r\n            .text((d) => d);\r\n        //\r\n        cells.enter()\r\n            .append('td')\r\n            .text((d) => d);\r\n        cells.exit().remove();\r\n    }\r\n}\r\ncustomElements.define('rama-scatter', RamaScatter);\r\n"]}